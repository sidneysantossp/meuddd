import{c as e,j as t,G as r,R as s,r as a,J as n,K as i,N as o,O as l,b as c,S as u,d,g as h,Q as f,M as p,V as m,B as g,e as y,f as v}from"./index-DpCJXB7j.js";import{e as b}from"./data-seo-BIGoikzq.js";import"./data-states-DfGa2p1E.js";import"./data-blog-CBVyISY4.js";
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=e("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),_=e("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function k({className:e,...s}){return t.jsx("textarea",{"data-slot":"textarea",className:r("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}var x=e=>"checkbox"===e.type,S=e=>e instanceof Date,E=e=>null==e;const T=e=>"object"==typeof e;var O=e=>!E(e)&&!Array.isArray(e)&&T(e)&&!S(e),j=e=>O(e)&&e.target?x(e.target)?e.target.checked:e.target.value:e,A=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),R="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function C(e){if(e instanceof Date)return new Date(e);const t="undefined"!=typeof FileList&&e instanceof FileList;if(R&&(e instanceof Blob||t))return e;const r=Array.isArray(e);if(!(r||O(e)&&(e=>{const t=e.constructor&&e.constructor.prototype;return O(t)&&t.hasOwnProperty("isPrototypeOf")})(e)))return e;const s=r?[]:Object.create(Object.getPrototypeOf(e));for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=C(e[a]));return s}var N=e=>/^\w*$/.test(e),I=e=>void 0===e,$=e=>Array.isArray(e)?e.filter(Boolean):[],P=e=>$(e.replace(/["|']|\]/g,"").split(/\.|\[/)),D=(e,t,r)=>{if(!t||!O(e))return r;const s=(N(t)?[t]:P(t)).reduce((e,t)=>E(e)?e:e[t],e);return I(s)||s===e?I(e[t])?r:e[t]:s},U=e=>"boolean"==typeof e,V=e=>"function"==typeof e,L=(e,t,r)=>{let s=-1;const a=N(t)?[t]:P(t),n=a.length,i=n-1;for(;++s<n;){const t=a[s];let n=r;if(s!==i){const r=e[t];n=O(r)||Array.isArray(r)?r:isNaN(+a[s+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=n,e=e[t]}};const F="blur",B="focusout",q="change",M="onBlur",z="onChange",K="onSubmit",W="onTouched",Z="all",J="max",H="min",G="maxLength",Y="minLength",X="pattern",Q="required",ee="validate",te=s.createContext(null);te.displayName="HookFormContext";const re=()=>s.useContext(te);var se=(e,t,r,s=!0)=>{const a={defaultValues:t._defaultValues};for(const n in e)Object.defineProperty(a,n,{get:()=>{const a=n;return t._proxyFormState[a]!==Z&&(t._proxyFormState[a]=!s||Z),r&&(r[a]=!0),e[a]}});return a};const ae="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;function ne(e){const t=re(),{control:r=t.control,disabled:a,name:n,exact:i}=e||{},[o,l]=s.useState(r._formState),c=s.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return ae(()=>r._subscribe({name:n,formState:c.current,exact:i,callback:e=>{!a&&l({...r._formState,...e})}}),[n,a,i]),s.useEffect(()=>{c.current.isValid&&r._setValid(!0)},[r]),s.useMemo(()=>se(o,r,c.current,!1),[o,r])}var ie=e=>"string"==typeof e,oe=(e,t,r,s,a)=>ie(e)?(s&&t.watch.add(e),D(r,e,a)):Array.isArray(e)?e.map(e=>(s&&t.watch.add(e),D(r,e))):(s&&(t.watchAll=!0),r),le=e=>E(e)||!T(e);function ce(e,t,r=new WeakSet){if(le(e)||le(t))return Object.is(e,t);if(S(e)&&S(t))return Object.is(e.getTime(),t.getTime());const s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const n of s){const s=e[n];if(!a.includes(n))return!1;if("ref"!==n){const e=t[n];if(S(s)&&S(e)||O(s)&&O(e)||Array.isArray(s)&&Array.isArray(e)?!ce(s,e,r):!Object.is(s,e))return!1}}return!0}function ue(e){const t=re(),{name:r,disabled:a,control:n=t.control,shouldUnregister:i,defaultValue:o,exact:l=!0}=e,c=A(n._names.array,r),u=s.useMemo(()=>D(n._formValues,r,D(n._defaultValues,r,o)),[n,r,o]),d=function(e){const t=re(),{control:r=t.control,name:a,defaultValue:n,disabled:i,exact:o,compute:l}=e||{},c=s.useRef(n),u=s.useRef(l),d=s.useRef(void 0),h=s.useRef(r),f=s.useRef(a);u.current=l;const[p,m]=s.useState(()=>{const e=r._getWatch(a,c.current);return u.current?u.current(e):e}),g=s.useCallback(e=>{const t=oe(a,r._names,e||r._formValues,!1,c.current);return u.current?u.current(t):t},[r._formValues,r._names,a]),y=s.useCallback(e=>{if(!i){const t=oe(a,r._names,e||r._formValues,!1,c.current);if(u.current){const e=u.current(t);ce(e,d.current)||(m(e),d.current=e)}else m(t)}},[r._formValues,r._names,i,a]);ae(()=>(h.current===r&&ce(f.current,a)||(h.current=r,f.current=a,y()),r._subscribe({name:a,formState:{values:!0},exact:o,callback:e=>{y(e.values)}})),[r,o,a,y]),s.useEffect(()=>r._removeUnmounted());const v=h.current!==r,b=f.current,w=s.useMemo(()=>{if(i)return null;const e=!v&&!ce(b,a);return v||e?g():null},[i,v,a,b,g]);return null!==w?w:p}({control:n,name:r,defaultValue:u,exact:l}),h=ne({control:n,name:r,exact:l}),f=s.useRef(e),p=s.useRef(void 0),m=s.useRef(n.register(r,{...e.rules,value:d,...U(e.disabled)?{disabled:e.disabled}:{}}));f.current=e;const g=s.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!D(h.errors,r)},isDirty:{enumerable:!0,get:()=>!!D(h.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!D(h.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!D(h.validatingFields,r)},error:{enumerable:!0,get:()=>D(h.errors,r)}}),[h,r]),y=s.useCallback(e=>m.current.onChange({target:{value:j(e),name:r},type:q}),[r]),v=s.useCallback(()=>m.current.onBlur({target:{value:D(n._formValues,r),name:r},type:F}),[r,n._formValues]),b=s.useCallback(e=>{const t=D(n._fields,r);t&&t._f&&e&&(t._f.ref={focus:()=>V(e.focus)&&e.focus(),select:()=>V(e.select)&&e.select(),setCustomValidity:t=>V(e.setCustomValidity)&&e.setCustomValidity(t),reportValidity:()=>V(e.reportValidity)&&e.reportValidity()})},[n._fields,r]),w=s.useMemo(()=>({name:r,value:d,...U(a)||h.disabled?{disabled:h.disabled||a}:{},onChange:y,onBlur:v,ref:b}),[r,a,h.disabled,y,v,b,d]);return s.useEffect(()=>{const e=n._options.shouldUnregister||i,t=p.current;t&&t!==r&&!c&&n.unregister(t),n.register(r,{...f.current.rules,...U(f.current.disabled)?{disabled:f.current.disabled}:{}});const s=(e,t)=>{const r=D(n._fields,e);r&&r._f&&(r._f.mount=t)};if(s(r,!0),e){const e=C(D(n._options.defaultValues,r,f.current.defaultValue));L(n._defaultValues,r,e),I(D(n._formValues,r))&&L(n._formValues,r,e)}return!c&&n.register(r),p.current=r,()=>{(c?e&&!n._state.action:e)?n.unregister(r):s(r,!1)}},[r,n,c,i]),s.useEffect(()=>{n._setDisabledField({disabled:a,name:r})},[a,r,n]),s.useMemo(()=>({field:w,formState:h,fieldState:g}),[w,h,g])}const de=e=>e.render(ue(e));var he=(e,t,r,s,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[s]:a||!0}}:{},fe=e=>Array.isArray(e)?e:[e],pe=()=>{let e=[];return{get observers(){return e},next:t=>{for(const r of e)r.next&&r.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}};function me(e,t){const r={};for(const s in e)if(e.hasOwnProperty(s)){const a=e[s],n=t[s];if(a&&O(a)&&n){const e=me(a,n);O(e)&&(r[s]=e)}else e[s]&&(r[s]=n)}return r}var ge=e=>O(e)&&!Object.keys(e).length,ye=e=>"file"===e.type,ve=e=>{if(!R)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},be=e=>"select-multiple"===e.type,we=e=>"radio"===e.type,_e=e=>ve(e)&&e.isConnected;function ke(e,t){const r=Array.isArray(t)?t:N(t)?[t]:P(t),s=1===r.length?e:function(e,t){const r=t.slice(0,-1).length;let s=0;for(;s<r;)e=I(e)?s++:e[t[s++]];return e}(e,r),a=r.length-1,n=r[a];return s&&delete s[n],0!==a&&(O(s)&&ge(s)||Array.isArray(s)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!I(e[t]))return!1;return!0}(s))&&ke(e,r.slice(0,-1)),e}function xe(e){return Array.isArray(e)||O(e)&&!(e=>{for(const t in e)if(V(e[t]))return!0;return!1})(e)}function Se(e,t={}){for(const r in e){const s=e[r];xe(s)?(t[r]=Array.isArray(s)?[]:{},Se(s,t[r])):I(s)||(t[r]=!0)}return t}function Ee(e,t,r){r||(r=Se(t));for(const s in e){const a=e[s];if(xe(a))I(t)||le(r[s])?r[s]=Se(a,Array.isArray(a)?[]:{}):Ee(a,E(t)?{}:t[s],r[s]);else{const e=t[s];r[s]=!ce(a,e)}}return r}const Te={value:!1,isValid:!1},Oe={value:!0,isValid:!0};var je=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!I(e[0].attributes.value)?I(e[0].value)||""===e[0].value?Oe:{value:e[0].value,isValid:!0}:Oe:Te}return Te},Ae=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:s})=>I(e)?e:t?""===e?NaN:e?+e:e:r&&ie(e)?new Date(e):s?s(e):e;const Re={isValid:!1,value:null};var Ce=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Re):Re;function Ne(e){const t=e.ref;return ye(t)?t.files:we(t)?Ce(e.refs).value:be(t)?[...t.selectedOptions].map(({value:e})=>e):x(t)?je(e.refs).value:Ae(I(t.value)?e.ref.value:t.value,e)}var Ie=e=>e instanceof RegExp,$e=e=>I(e)?e:Ie(e)?e.source:O(e)?Ie(e.value)?e.value.source:e.value:e,Pe=e=>({isOnSubmit:!e||e===K,isOnBlur:e===M,isOnChange:e===z,isOnAll:e===Z,isOnTouch:e===W});const De="AsyncFunction";var Ue=e=>!!e&&!!e.validate&&!!(V(e.validate)&&e.validate.constructor.name===De||O(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===De)),Ve=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));const Le=(e,t,r,s)=>{for(const a of r||Object.keys(e)){const r=D(e,a);if(r){const{_f:e,...n}=r;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],a)&&!s)return!0;if(e.ref&&t(e.ref,e.name)&&!s)return!0;if(Le(n,t))break}else if(O(n)&&Le(n,t))break}}};function Fe(e,t,r){const s=D(e,r);if(s||N(r))return{error:s,name:r};const a=r.split(".");for(;a.length;){const s=a.join("."),n=D(t,s),i=D(e,s);if(n&&!Array.isArray(n)&&r!==s)return{name:r};if(i&&i.type)return{name:s,error:i};if(i&&i.root&&i.root.type)return{name:`${s}.root`,error:i.root};a.pop()}return{name:r}}var Be=(e,t,r)=>{const s=fe(D(e,r));return L(s,"root",t[r]),L(e,r,s),e};function qe(e,t,r="validate"){if(ie(e)||Array.isArray(e)&&e.every(ie)||U(e)&&!e)return{type:r,message:ie(e)?e:"",ref:t}}var Me=e=>O(e)&&!Ie(e)?e:{value:e,message:""},ze=async(e,t,r,s,a,n)=>{const{ref:i,refs:o,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:f,validate:p,name:m,valueAsNumber:g,mount:y}=e._f,v=D(r,m);if(!y||t.has(m))return{};const b=o?o[0]:i,w=e=>{a&&b.reportValidity&&(b.setCustomValidity(U(e)?"":e||""),b.reportValidity())},_={},k=we(i),S=x(i),T=k||S,j=(g||ye(i))&&I(i.value)&&I(v)||ve(i)&&""===i.value||""===v||Array.isArray(v)&&!v.length,A=he.bind(null,m,s,_),R=(e,t,r,s=G,a=Y)=>{const n=e?t:r;_[m]={type:e?s:a,message:n,ref:i,...A(e?s:a,n)}};if(n?!Array.isArray(v)||!v.length:l&&(!T&&(j||E(v))||U(v)&&!v||S&&!je(o).isValid||k&&!Ce(o).isValid)){const{value:e,message:t}=ie(l)?{value:!!l,message:l}:Me(l);if(e&&(_[m]={type:Q,message:t,ref:b,...A(Q,t)},!s))return w(t),_}if(!(j||E(d)&&E(h))){let e,t;const r=Me(h),a=Me(d);if(E(v)||isNaN(v)){const s=i.valueAsDate||new Date(v),n=e=>new Date((new Date).toDateString()+" "+e),o="time"==i.type,l="week"==i.type;ie(r.value)&&v&&(e=o?n(v)>n(r.value):l?v>r.value:s>new Date(r.value)),ie(a.value)&&v&&(t=o?n(v)<n(a.value):l?v<a.value:s<new Date(a.value))}else{const s=i.valueAsNumber||(v?+v:v);E(r.value)||(e=s>r.value),E(a.value)||(t=s<a.value)}if((e||t)&&(R(!!e,r.message,a.message,J,H),!s))return w(_[m].message),_}if((c||u)&&!j&&(ie(v)||n&&Array.isArray(v))){const e=Me(c),t=Me(u),r=!E(e.value)&&v.length>+e.value,a=!E(t.value)&&v.length<+t.value;if((r||a)&&(R(r,e.message,t.message),!s))return w(_[m].message),_}if(f&&!j&&ie(v)){const{value:e,message:t}=Me(f);if(Ie(e)&&!v.match(e)&&(_[m]={type:X,message:t,ref:i,...A(X,t)},!s))return w(t),_}if(p)if(V(p)){const e=qe(await p(v,r),b);if(e&&(_[m]={...e,...A(ee,e.message)},!s))return w(e.message),_}else if(O(p)){let e={};for(const t in p){if(!ge(e)&&!s)break;const a=qe(await p[t](v,r),b,t);a&&(e={...a,...A(t,a.message)},w(a.message),s&&(_[m]=e))}if(!ge(e)&&(_[m]={ref:b,...e},!s))return _}return w(!0),_};const Ke={mode:K,reValidateMode:z,shouldFocusError:!0};function We(e={}){let t,r={...Ke,...e},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:V(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},n=(O(r.defaultValues)||O(r.values))&&C(r.defaultValues||r.values)||{},i=r.shouldUnregister?{}:C(n),o={action:!1,mount:!1,watch:!1,keepIsValid:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={...u};let h={...d};const f={array:pe(),state:pe()},p=r.criteriaMode===Z,m=async e=>{if(!o.keepIsValid&&!r.disabled&&(d.isValid||h.isValid||e)){let e;r.resolver?(e=ge((await w()).errors),g()):e=await _(a,!0),e!==s.isValid&&f.state.next({isValid:e})}},g=(e,t)=>{!r.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((e||Array.from(l.mount)).forEach(e=>{e&&(t?L(s.validatingFields,e,t):ke(s.validatingFields,e))}),f.state.next({validatingFields:s.validatingFields,isValidating:!ge(s.validatingFields)}))},y=(e,t,r,s)=>{const l=D(a,e);if(l){const a=D(i,e,I(r)?D(n,e):r);I(a)||s&&s.defaultChecked||t?L(i,e,t?a:Ne(l._f)):N(e,a),o.mount&&!o.action&&m()}},v=(e,t,a,i,o)=>{let l=!1,c=!1;const u={name:e};if(!r.disabled){if(!a||i){(d.isDirty||h.isDirty)&&(c=s.isDirty,s.isDirty=u.isDirty=k(),l=c!==u.isDirty);const r=ce(D(n,e),t);c=!!D(s.dirtyFields,e),r?ke(s.dirtyFields,e):L(s.dirtyFields,e,!0),u.dirtyFields=s.dirtyFields,l=l||(d.dirtyFields||h.dirtyFields)&&c!==!r}if(a){const t=D(s.touchedFields,e);t||(L(s.touchedFields,e,a),u.touchedFields=s.touchedFields,l=l||(d.touchedFields||h.touchedFields)&&t!==a)}l&&o&&f.state.next(u)}return l?u:{}},b=(e,a,n,i)=>{const o=D(s.errors,e),l=(d.isValid||h.isValid)&&U(a)&&s.isValid!==a;var u;if(r.delayError&&n?(u=()=>((e,t)=>{L(s.errors,e,t),f.state.next({errors:s.errors})})(e,n),t=e=>{clearTimeout(c),c=setTimeout(u,e)},t(r.delayError)):(clearTimeout(c),t=null,n?L(s.errors,e,n):ke(s.errors,e)),(n?!ce(o,n):o)||!ge(i)||l){const t={...i,...l&&U(a)?{isValid:a}:{},errors:s.errors,name:e};s={...s,...t},f.state.next(t)}},w=async e=>{g(e,!0);const t=await r.resolver(i,r.context,((e,t,r,s)=>{const a={};for(const n of e){const e=D(t,n);e&&L(a,n,e._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:s}})(e||l.mount,a,r.criteriaMode,r.shouldUseNativeValidation));return t},_=async(t,a,n={valid:!0})=>{for(const o in t){const c=t[o];if(c){const{_f:t,...o}=c;if(t){const o=l.array.has(t.name),u=c._f&&Ue(c._f);u&&d.validatingFields&&g([t.name],!0);const h=await ze(c,l.disabled,i,p,r.shouldUseNativeValidation&&!a,o);if(u&&d.validatingFields&&g([t.name]),h[t.name]&&(n.valid=!1,a||e.shouldUseNativeValidation))break;!a&&(D(h,t.name)?o?Be(s.errors,h,t.name):L(s.errors,t.name,h[t.name]):ke(s.errors,t.name))}!ge(o)&&await _(o,a,n)}}return n.valid},k=(e,t)=>!r.disabled&&(e&&t&&L(i,e,t),!ce(W(),n)),T=(e,t,r)=>oe(e,l,{...o.mount?i:I(t)?n:ie(e)?{[e]:t}:t},r,t),N=(e,t,r={})=>{const s=D(a,e);let n=t;if(s){const r=s._f;r&&(!r.disabled&&L(i,e,Ae(t,r)),n=ve(r.ref)&&E(t)?"":t,be(r.ref)?[...r.ref.options].forEach(e=>e.selected=n.includes(e.value)):r.refs?x(r.ref)?r.refs.forEach(e=>{e.defaultChecked&&e.disabled||(Array.isArray(n)?e.checked=!!n.find(t=>t===e.value):e.checked=n===e.value||!!n)}):r.refs.forEach(e=>e.checked=e.value===n):ye(r.ref)?r.ref.value="":(r.ref.value=n,r.ref.type||f.state.next({name:e,values:C(i)})))}(r.shouldDirty||r.shouldTouch)&&v(e,n,r.shouldTouch,r.shouldDirty,!0),r.shouldValidate&&K(e)},P=(e,t,r)=>{for(const s in t){if(!t.hasOwnProperty(s))return;const n=t[s],i=e+"."+s,o=D(a,i);(l.array.has(e)||O(n)||o&&!o._f)&&!S(n)?P(i,n,r):N(i,n,r)}},q=(e,t,r={})=>{const c=D(a,e),u=l.array.has(e),p=C(t);L(i,e,p),u?(f.array.next({name:e,values:C(i)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&r.shouldDirty&&f.state.next({name:e,dirtyFields:Ee(n,i),isDirty:k(e,p)})):!c||c._f||E(p)?N(e,p,r):P(e,p,r),Ve(e,l)?f.state.next({...s,name:e,values:C(i)}):f.state.next({name:o.mount?e:void 0,values:C(i)})},M=async e=>{o.mount=!0;const n=e.target;let c=n.name,u=!0;const y=D(a,c),k=e=>{u=Number.isNaN(e)||S(e)&&isNaN(e.getTime())||ce(e,D(i,c,e))},x=Pe(r.mode),E=Pe(r.reValidateMode);if(y){let o,S;const O=n.type?Ne(y._f):j(e),A=e.type===F||e.type===B,R=!((T=y._f).mount&&(T.required||T.min||T.max||T.maxLength||T.minLength||T.pattern||T.validate)||r.resolver||D(s.errors,c)||y._f.deps)||((e,t,r,s,a)=>!a.isOnAll&&(!r&&a.isOnTouch?!(t||e):(r?s.isOnBlur:a.isOnBlur)?!e:!(r?s.isOnChange:a.isOnChange)||e))(A,D(s.touchedFields,c),s.isSubmitted,E,x),N=Ve(c,l,A);L(i,c,O),A?n&&n.readOnly||(y._f.onBlur&&y._f.onBlur(e),t&&t(0)):y._f.onChange&&y._f.onChange(e);const I=v(c,O,A),$=!ge(I)||N;if(!A&&f.state.next({name:c,type:e.type,values:C(i)}),R)return(d.isValid||h.isValid)&&("onBlur"===r.mode?A&&m():A||m()),$&&f.state.next({name:c,...N?{}:I});if(!A&&N&&f.state.next({...s}),r.resolver){const{errors:e}=await w([c]);if(g([c]),k(O),u){const t=Fe(s.errors,a,c),r=Fe(e,a,t.name||c);o=r.error,c=r.name,S=ge(e)}}else g([c],!0),o=(await ze(y,l.disabled,i,p,r.shouldUseNativeValidation))[c],g([c]),k(O),u&&(o?S=!1:(d.isValid||h.isValid)&&(S=await _(a,!0)));u&&(y._f.deps&&(!Array.isArray(y._f.deps)||y._f.deps.length>0)&&K(y._f.deps),b(c,S,o,I))}var T},z=(e,t)=>{if(D(s.errors,t)&&e.focus)return e.focus(),1},K=async(e,t={})=>{let n,i;const o=fe(e);if(r.resolver){const t=await(async e=>{const{errors:t}=await w(e);if(g(e),e)for(const r of e){const e=D(t,r);e?L(s.errors,r,e):ke(s.errors,r)}else s.errors=t;return t})(I(e)?e:o);n=ge(t),i=e?!o.some(e=>D(t,e)):n}else e?(i=(await Promise.all(o.map(async e=>{const t=D(a,e);return await _(t&&t._f?{[e]:t}:t)}))).every(Boolean),(i||s.isValid)&&m()):i=n=await _(a);return f.state.next({...!ie(e)||(d.isValid||h.isValid)&&n!==s.isValid?{}:{name:e},...r.resolver||!e?{isValid:n}:{},errors:s.errors}),t.shouldFocus&&!i&&Le(a,z,e?o:l.mount),i},W=(e,t)=>{let r={...o.mount?i:n};return t&&(r=me(t.dirtyFields?s.dirtyFields:s.touchedFields,r)),I(e)?r:ie(e)?D(r,e):e.map(e=>D(r,e))},J=(e,t)=>({invalid:!!D((t||s).errors,e),isDirty:!!D((t||s).dirtyFields,e),error:D((t||s).errors,e),isValidating:!!D(s.validatingFields,e),isTouched:!!D((t||s).touchedFields,e)}),H=(e,t,r)=>{const n=(D(a,e,{_f:{}})._f||{}).ref,i=D(s.errors,e)||{},{ref:o,message:l,type:c,...u}=i;L(s.errors,e,{...u,...t,ref:n}),f.state.next({name:e,errors:s.errors,isValid:!1}),r&&r.shouldFocus&&n&&n.focus&&n.focus()},G=e=>f.state.subscribe({next:t=>{var r,a,o;r=e.name,a=t.name,o=e.exact,r&&a&&r!==a&&!fe(r).some(e=>e&&(o?e===a:e.startsWith(a)||a.startsWith(e)))||!((e,t,r,s)=>{r(e);const{name:a,...n}=e;return ge(n)||Object.keys(n).length>=Object.keys(t).length||Object.keys(n).find(e=>t[e]===(!s||Z))})(t,e.formState||d,ae,e.reRenderRoot)||e.callback({values:{...i},...s,...t,defaultValues:n})}}).unsubscribe,Y=(e,t={})=>{for(const o of e?fe(e):l.mount)l.mount.delete(o),l.array.delete(o),t.keepValue||(ke(a,o),ke(i,o)),!t.keepError&&ke(s.errors,o),!t.keepDirty&&ke(s.dirtyFields,o),!t.keepTouched&&ke(s.touchedFields,o),!t.keepIsValidating&&ke(s.validatingFields,o),!r.shouldUnregister&&!t.keepDefaultValue&&ke(n,o);f.state.next({values:C(i)}),f.state.next({...s,...t.keepDirty?{isDirty:k()}:{}}),!t.keepIsValid&&m()},X=({disabled:e,name:t})=>{(U(e)&&o.mount||e||l.disabled.has(t))&&(e?l.disabled.add(t):l.disabled.delete(t))},Q=(e,t={})=>{let s=D(a,e);const i=U(t.disabled)||U(r.disabled);return L(a,e,{...s||{},_f:{...s&&s._f?s._f:{ref:{name:e}},name:e,mount:!0,...t}}),l.mount.add(e),s?X({disabled:U(t.disabled)?t.disabled:r.disabled,name:e}):y(e,!0,t.value),{...i?{disabled:t.disabled||r.disabled}:{},...r.progressive?{required:!!t.required,min:$e(t.min),max:$e(t.max),minLength:$e(t.minLength),maxLength:$e(t.maxLength),pattern:$e(t.pattern)}:{},name:e,onChange:M,onBlur:M,ref:i=>{if(i){Q(e,t),s=D(a,e);const r=I(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,o=(e=>we(e)||x(e))(r),l=s._f.refs||[];if(o?l.find(e=>e===r):r===s._f.ref)return;L(a,e,{_f:{...s._f,...o?{refs:[...l.filter(_e),r,...Array.isArray(D(n,e))?[{}]:[]],ref:{type:r.type,name:e}}:{ref:r}}}),y(e,!1,void 0,r)}else s=D(a,e,{}),s._f&&(s._f.mount=!1),(r.shouldUnregister||t.shouldUnregister)&&(!A(l.array,e)||!o.action)&&l.unMount.add(e)}}},ee=()=>r.shouldFocusError&&Le(a,z,l.mount),te=(e,t)=>async n=>{let o;n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let c=C(i);if(f.state.next({isSubmitting:!0}),r.resolver){const{errors:e,values:t}=await w();g(),s.errors=e,c=C(t)}else await _(a);if(l.disabled.size)for(const e of l.disabled)ke(c,e);if(ke(s.errors,"root"),ge(s.errors)){f.state.next({errors:{}});try{await e(c,n)}catch(u){o=u}}else t&&await t({...s.errors},n),ee(),setTimeout(ee);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ge(s.errors)&&!o,submitCount:s.submitCount+1,errors:s.errors}),o)throw o},re=(e,t={})=>{const c=e?C(e):n,u=C(c),h=ge(e),p=h?n:u;if(t.keepDefaultValues||(n=c),!t.keepValues){if(t.keepDirtyValues){const e=new Set([...l.mount,...Object.keys(Ee(n,i))]);for(const t of Array.from(e)){const e=D(s.dirtyFields,t),r=D(i,t),a=D(p,t);e&&!I(r)?L(p,t,r):e||I(a)||q(t,a)}}else{if(R&&I(e))for(const e of l.mount){const t=D(a,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(ve(e)){const t=e.closest("form");if(t){t.reset();break}}}}if(t.keepFieldsRef)for(const e of l.mount)q(e,D(p,e));else a={}}i=r.shouldUnregister?t.keepDefaultValues?C(n):{}:C(p),f.array.next({values:{...p}}),f.state.next({values:{...p}})}l={mount:t.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues||!r.shouldUnregister&&!ge(p),o.watch=!!r.shouldUnregister,o.keepIsValid=!!t.keepIsValid,o.action=!1,t.keepErrors||(s.errors={}),f.state.next({submitCount:t.keepSubmitCount?s.submitCount:0,isDirty:!h&&(t.keepDirty?s.isDirty:!(!t.keepDefaultValues||ce(e,n))),isSubmitted:!!t.keepIsSubmitted&&s.isSubmitted,dirtyFields:h?{}:t.keepDirtyValues?t.keepDefaultValues&&i?Ee(n,i):s.dirtyFields:t.keepDefaultValues&&e?Ee(n,e):t.keepDirty?s.dirtyFields:{},touchedFields:t.keepTouched?s.touchedFields:{},errors:t.keepErrors?s.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&s.isSubmitSuccessful,isSubmitting:!1,defaultValues:n})},se=(e,t)=>re(V(e)?e(i):e,{...r.resetOptions,...t}),ae=e=>{s={...s,...e}},ne={control:{register:Q,unregister:Y,getFieldState:J,handleSubmit:te,setError:H,_subscribe:G,_runSchema:w,_updateIsValidating:g,_focusError:ee,_getWatch:T,_getDirty:k,_setValid:m,_setFieldArray:(e,t=[],l,c,u=!0,p=!0)=>{if(c&&l&&!r.disabled){if(o.action=!0,p&&Array.isArray(D(a,e))){const t=l(D(a,e),c.argA,c.argB);u&&L(a,e,t)}if(p&&Array.isArray(D(s.errors,e))){const t=l(D(s.errors,e),c.argA,c.argB);u&&L(s.errors,e,t),((e,t)=>{!$(D(e,t)).length&&ke(e,t)})(s.errors,e)}if((d.touchedFields||h.touchedFields)&&p&&Array.isArray(D(s.touchedFields,e))){const t=l(D(s.touchedFields,e),c.argA,c.argB);u&&L(s.touchedFields,e,t)}(d.dirtyFields||h.dirtyFields)&&(s.dirtyFields=Ee(n,i)),f.state.next({name:e,isDirty:k(e,t),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else L(i,e,t)},_setDisabledField:X,_setErrors:e=>{s.errors=e,f.state.next({errors:s.errors,isValid:!1})},_getFieldArray:e=>$(D(o.mount?i:n,e,r.shouldUnregister?D(n,e,[]):[])),_reset:re,_resetDefaultValues:()=>V(r.defaultValues)&&r.defaultValues().then(e=>{se(e,r.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(const e of l.unMount){const t=D(a,e);t&&(t._f.refs?t._f.refs.every(e=>!_e(e)):!_e(t._f.ref))&&Y(e)}l.unMount=new Set},_disableForm:e=>{U(e)&&(f.state.next({disabled:e}),Le(a,(t,r)=>{const s=D(a,r);s&&(t.disabled=s._f.disabled||e,Array.isArray(s._f.refs)&&s._f.refs.forEach(t=>{t.disabled=s._f.disabled||e}))},0,!1))},_subjects:f,_proxyFormState:d,get _fields(){return a},get _formValues(){return i},get _state(){return o},set _state(e){o=e},get _defaultValues(){return n},get _names(){return l},set _names(e){l=e},get _formState(){return s},get _options(){return r},set _options(e){r={...r,...e}}},subscribe:e=>(o.mount=!0,h={...h,...e.formState},G({...e,formState:{...u,...e.formState}})),trigger:K,register:Q,handleSubmit:te,watch:(e,t)=>V(e)?f.state.subscribe({next:r=>"values"in r&&e(T(void 0,t),r)}):T(e,t,!0),setValue:q,getValues:W,reset:se,resetField:(e,t={})=>{D(a,e)&&(I(t.defaultValue)?q(e,C(D(n,e))):(q(e,t.defaultValue),L(n,e,C(t.defaultValue))),t.keepTouched||ke(s.touchedFields,e),t.keepDirty||(ke(s.dirtyFields,e),s.isDirty=t.defaultValue?k(e,C(D(n,e))):k()),t.keepError||(ke(s.errors,e),d.isValid&&m()),f.state.next({...s}))},clearErrors:e=>{e&&fe(e).forEach(e=>ke(s.errors,e)),f.state.next({errors:e?s.errors:{}})},unregister:Y,setError:H,setFocus:(e,t={})=>{const r=D(a,e),s=r&&r._f;if(s){const e=s.refs?s.refs[0]:s.ref;e.focus&&setTimeout(()=>{e.focus(),t.shouldSelect&&V(e.select)&&e.select()})}},getFieldState:J};return{...ne,formControl:ne}}var Ze=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{const s=n(`Primitive.${r}`),i=a.forwardRef((e,a)=>{const{asChild:n,...i}=e,o=n?s:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),t.jsx(o,{...i,ref:a})});return i.displayName=`Primitive.${r}`,{...e,[r]:i}},{}),Je=a.forwardRef((e,r)=>t.jsx(Ze.label,{...e,ref:r,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Je.displayName="Label";var He=Je;function Ge({className:e,...s}){return t.jsx(He,{"data-slot":"label",className:r("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...s})}const Ye=e=>{const{children:t,...r}=e;return s.createElement(te.Provider,{value:r},t)},Xe=a.createContext({}),Qe=({...e})=>t.jsx(Xe.Provider,{value:{name:e.name},children:t.jsx(de,{...e})}),et=()=>{const e=a.useContext(Xe),t=a.useContext(tt),{getFieldState:r}=re(),s=ne({name:e.name}),n=r(e.name,s);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},tt=a.createContext({});function rt({className:e,...s}){const n=a.useId();return t.jsx(tt.Provider,{value:{id:n},children:t.jsx("div",{"data-slot":"form-item",className:r("grid gap-2",e),...s})})}function st({className:e,...s}){const{error:a,formItemId:n}=et();return t.jsx(Ge,{"data-slot":"form-label","data-error":!!a,className:r("data-[error=true]:text-destructive",e),htmlFor:n,...s})}function at({...e}){const{error:r,formItemId:s,formDescriptionId:a,formMessageId:n}=et();return t.jsx(i,{"data-slot":"form-control",id:s,"aria-describedby":r?`${a} ${n}`:`${a}`,"aria-invalid":!!r,...e})}function nt({className:e,...s}){const{error:a,formMessageId:n}=et(),i=a?String((null==a?void 0:a.message)??""):s.children;return i?t.jsx("p",{"data-slot":"form-message",id:n,className:r("text-destructive text-sm",e),...s,children:i}):null}const it=(e,t,r)=>{if(e&&"reportValidity"in e){const s=D(r,t);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},ot=(e,t)=>{for(const r in t.fields){const s=t.fields[r];s&&s.ref&&"reportValidity"in s.ref?it(s.ref,r,e):s&&s.refs&&s.refs.forEach(t=>it(t,r,e))}},lt=(e,t)=>{t.shouldUseNativeValidation&&ot(e,t);const r={};for(const s in e){const a=D(t.fields,s),n=Object.assign(e[s]||{},{ref:a&&a.ref});if(ct(t.names||Object.keys(e),s)){const e=Object.assign({},D(r,s));L(e,"root",n),L(r,s,e)}else L(r,s,n)}return r},ct=(e,t)=>{const r=ut(t);return e.some(e=>ut(e).match(`^${r}\\.\\d+`))};function ut(e){return e.replace(/\]|\[/g,"")}function dt(e,t,r){function s(r,s){var a;Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(a=r._zod).traits??(a.traits=new Set),r._zod.traits.add(e),t(r,s);for(const e in i.prototype)e in r||Object.defineProperty(r,e,{value:i.prototype[e].bind(r)});r._zod.constr=i,r._zod.def=s}const a=(null==r?void 0:r.Parent)??Object;class n extends a{}function i(e){var t;const a=(null==r?void 0:r.Parent)?new n:this;s(a,e),(t=a._zod).deferred??(t.deferred=[]);for(const r of a._zod.deferred)r();return a}return Object.defineProperty(n,"name",{value:e}),Object.defineProperty(i,"init",{value:s}),Object.defineProperty(i,Symbol.hasInstance,{value:t=>{var s,a;return!!((null==r?void 0:r.Parent)&&t instanceof r.Parent)||(null==(a=null==(s=null==t?void 0:t._zod)?void 0:s.traits)?void 0:a.has(e))}}),Object.defineProperty(i,"name",{value:e}),i}class ht extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const ft={};function pt(e){return ft}function mt(e,t){return"bigint"==typeof t?t.toString():t}const gt=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function yt(e){return"string"==typeof e?e:null==e?void 0:e.message}function vt(e,t,r){var s,a,n,i,o,l;const c={...e,path:e.path??[]};if(!e.message){const u=yt(null==(n=null==(a=null==(s=e.inst)?void 0:s._zod.def)?void 0:a.error)?void 0:n.call(a,e))??yt(null==(i=null==t?void 0:t.error)?void 0:i.call(t,e))??yt(null==(o=r.customError)?void 0:o.call(r,e))??yt(null==(l=r.localeError)?void 0:l.call(r,e))??"Invalid input";c.message=u}return delete c.inst,delete c.continue,(null==t?void 0:t.reportInput)||delete c.input,c}const bt=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,mt,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},wt=dt("$ZodError",bt),_t=dt("$ZodError",bt,{Parent:Error}),kt=(e=>(t,r,s,a)=>{const n=s?Object.assign(s,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},n);if(i instanceof Promise)throw new ht;if(i.issues.length){const t=new((null==a?void 0:a.Err)??e)(i.issues.map(e=>vt(e,n,pt())));throw gt(t,null==a?void 0:a.callee),t}return i.value})(_t),xt=(e=>async(t,r,s,a)=>{const n=s?Object.assign(s,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},n);if(i instanceof Promise&&(i=await i),i.issues.length){const t=new((null==a?void 0:a.Err)??e)(i.issues.map(e=>vt(e,n,pt())));throw gt(t,null==a?void 0:a.callee),t}return i.value})(_t);function St(e,t){try{var r=e()}catch(s){return t(s)}return r&&r.then?r.then(void 0,t):r}function Et(e,t){for(var r={};e.length;){var s=e[0],a=s.code,n=s.message,i=s.path.join(".");if(!r[i])if("unionErrors"in s){var o=s.unionErrors[0].errors[0];r[i]={message:o.message,type:o.code}}else r[i]={message:n,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),t){var l=r[i].types,c=l&&l[s.code];r[i]=he(i,t,r,a,c?[].concat(c,s.message):s.message)}e.shift()}return r}function Tt(e,t){for(var r={};e.length;){var s=e[0],a=s.code,n=s.message,i=s.path.join(".");if(!r[i])if("invalid_union"===s.code&&s.errors.length>0){var o=s.errors[0][0];r[i]={message:o.message,type:o.code}}else r[i]={message:n,type:a};if("invalid_union"===s.code&&s.errors.forEach(function(t){return t.forEach(function(t){return e.push(t)})}),t){var l=r[i].types,c=l&&l[s.code];r[i]=he(i,t,r,a,c?[].concat(c,s.message):s.message)}e.shift()}return r}function Ot(e,t,r){if(void 0===r&&(r={}),"_def"in(s=e)&&"object"==typeof s._def&&"typeName"in s._def)return function(a,n,i){try{return Promise.resolve(St(function(){return Promise.resolve(e["sync"===r.mode?"parse":"parseAsync"](a,t)).then(function(e){return i.shouldUseNativeValidation&&ot({},i),{errors:{},values:r.raw?Object.assign({},a):e}})},function(e){if(t=e,Array.isArray(null==t?void 0:t.issues))return{values:{},errors:lt(Et(e.errors,!i.shouldUseNativeValidation&&"all"===i.criteriaMode),i)};var t;throw e}))}catch(s){return Promise.reject(s)}};var s;if(function(e){return"_zod"in e&&"object"==typeof e._zod}(e))return function(a,n,i){try{return Promise.resolve(St(function(){return Promise.resolve(("sync"===r.mode?kt:xt)(e,a,t)).then(function(e){return i.shouldUseNativeValidation&&ot({},i),{errors:{},values:r.raw?Object.assign({},a):e}})},function(e){if(e instanceof wt)return{values:{},errors:lt(Tt(e.issues,!i.shouldUseNativeValidation&&"all"===i.criteriaMode),i)};throw e}))}catch(s){return Promise.reject(s)}};throw new Error("Invalid input: not a Zod schema")}var jt,At,Rt;(At=jt||(jt={})).assertEqual=e=>{},At.assertIs=function(e){},At.assertNever=function(e){throw new Error},At.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},At.getValidEnumValues=e=>{const t=At.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),r={};for(const s of t)r[s]=e[s];return At.objectValues(r)},At.objectValues=e=>At.objectKeys(e).map(function(t){return e[t]}),At.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},At.find=(e,t)=>{for(const r of e)if(t(r))return r},At.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,At.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},At.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(Rt||(Rt={})).mergeShapes=(e,t)=>({...e,...t});const Ct=jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Nt=e=>{switch(typeof e){case"undefined":return Ct.undefined;case"string":return Ct.string;case"number":return Number.isNaN(e)?Ct.nan:Ct.number;case"boolean":return Ct.boolean;case"function":return Ct.function;case"bigint":return Ct.bigint;case"symbol":return Ct.symbol;case"object":return Array.isArray(e)?Ct.array:null===e?Ct.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Ct.promise:"undefined"!=typeof Map&&e instanceof Map?Ct.map:"undefined"!=typeof Set&&e instanceof Set?Ct.set:"undefined"!=typeof Date&&e instanceof Date?Ct.date:Ct.object;default:return Ct.unknown}},It=jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class $t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},r={_errors:[]},s=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(s);else if("invalid_return_type"===a.code)s(a.returnTypeError);else if("invalid_arguments"===a.code)s(a.argumentsError);else if(0===a.path.length)r._errors.push(t(a));else{let e=r,s=0;for(;s<a.path.length;){const r=a.path[s];s===a.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(a))):e[r]=e[r]||{_errors:[]},e=e[r],s++}}};return s(this),r}static assert(e){if(!(e instanceof $t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,jt.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const r=s.path[0];t[r]=t[r]||[],t[r].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}$t.create=e=>new $t(e);const Pt=(e,t)=>{let r;switch(e.code){case It.invalid_type:r=e.received===Ct.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case It.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,jt.jsonStringifyReplacer)}`;break;case It.unrecognized_keys:r=`Unrecognized key(s) in object: ${jt.joinValues(e.keys,", ")}`;break;case It.invalid_union:r="Invalid input";break;case It.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${jt.joinValues(e.options)}`;break;case It.invalid_enum_value:r=`Invalid enum value. Expected ${jt.joinValues(e.options)}, received '${e.received}'`;break;case It.invalid_arguments:r="Invalid function arguments";break;case It.invalid_return_type:r="Invalid function return type";break;case It.invalid_date:r="Invalid date";break;case It.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:jt.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case It.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case It.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case It.custom:r="Invalid input";break;case It.invalid_intersection_types:r="Intersection results could not be merged";break;case It.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case It.not_finite:r="Number must be finite";break;default:r=t.defaultError,jt.assertNever(e)}return{message:r}};let Dt=Pt;function Ut(e,t){const r=Dt,s=(e=>{const{data:t,path:r,errorMaps:s,issueData:a}=e,n=[...r,...a.path||[]],i={...a,path:n};if(void 0!==a.message)return{...a,path:n,message:a.message};let o="";const l=s.filter(e=>!!e).slice().reverse();for(const c of l)o=c(i,{data:t,defaultError:o}).message;return{...a,path:n,message:o}})({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Pt?void 0:Pt].filter(e=>!!e)});e.common.issues.push(s)}class Vt{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if("aborted"===s.status)return Lt;"dirty"===s.status&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const e=await s.key,t=await s.value;r.push({key:e,value:t})}return Vt.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:t,value:a}=s;if("aborted"===t.status)return Lt;if("aborted"===a.status)return Lt;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!s.alwaysSet||(r[t.value]=a.value)}return{status:e.value,value:r}}}const Lt=Object.freeze({status:"aborted"}),Ft=e=>({status:"dirty",value:e}),Bt=e=>({status:"valid",value:e}),qt=e=>"aborted"===e.status,Mt=e=>"dirty"===e.status,zt=e=>"valid"===e.status,Kt=e=>"undefined"!=typeof Promise&&e instanceof Promise;var Wt,Zt;(Zt=Wt||(Wt={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},Zt.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class Jt{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ht=(e,t)=>{if(zt(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new $t(e.common.issues);return this._error=t,this._error}}};function Gt(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:s,description:a}=e;if(t&&(r||s))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{const{message:n}=e;return"invalid_enum_value"===t.code?{message:n??a.defaultError}:void 0===a.data?{message:n??s??a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:n??r??a.defaultError}},description:a}}class Yt{get description(){return this._def.description}_getType(e){return Nt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Nt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Vt,ctx:{common:e.parent.common,data:e.data,parsedType:Nt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Kt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:(null==t?void 0:t.async)??!1,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Nt(e)},s=this._parseSync({data:e,path:r.path,parent:r});return Ht(r,s)}"~validate"(e){var t,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Nt(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:s});return zt(t)?{value:t.value}:{issues:s.common.issues}}catch(a){(null==(r=null==(t=null==a?void 0:a.message)?void 0:t.toLowerCase())?void 0:r.includes("encountered"))&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(e=>zt(e)?{value:e.value}:{issues:s.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Nt(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(Kt(s)?s:Promise.resolve(s));return Ht(r,a)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,s)=>{const a=e(t),n=()=>s.addIssue({code:It.custom,...r(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then(e=>!!e||(n(),!1)):!!a||(n(),!1)})}refinement(e,t){return this._refinement((r,s)=>!!e(r)||(s.addIssue("function"==typeof t?t(r,s):t),!1))}_refinement(e){return new Hr({schema:this,typeName:as.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Gr.create(this,this._def)}nullable(){return Yr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $r.create(this)}promise(){return Jr.create(this,this._def)}or(e){return Ur.create([this,e],this._def)}and(e){return Lr.create(this,e,this._def)}transform(e){return new Hr({...Gt(this._def),schema:this,typeName:as.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Xr({...Gt(this._def),innerType:this,defaultValue:t,typeName:as.ZodDefault})}brand(){return new ts({typeName:as.ZodBranded,type:this,...Gt(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Qr({...Gt(this._def),innerType:this,catchValue:t,typeName:as.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return rs.create(this,e)}readonly(){return ss.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Xt=/^c[^\s-]{8,}$/i,Qt=/^[0-9a-z]+$/,er=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tr=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,rr=/^[a-z0-9_-]{21}$/i,sr=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ar=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nr=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let ir;const or=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,cr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ur=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,dr=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,hr=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,fr="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pr=new RegExp(`^${fr}$`);function mr(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function gr(e){return new RegExp(`^${mr(e)}$`)}function yr(e){let t=`${fr}T${mr(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function vr(e,t){return!("v4"!==t&&t||!or.test(e))||!("v6"!==t&&t||!cr.test(e))}function br(e,t){if(!sr.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(s));return"object"==typeof a&&null!==a&&((!("typ"in a)||"JWT"===(null==a?void 0:a.typ))&&(!!a.alg&&(!t||a.alg===t)))}catch{return!1}}function wr(e,t){return!("v4"!==t&&t||!lr.test(e))||!("v6"!==t&&t||!ur.test(e))}class _r extends Yt{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==Ct.string){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.string,received:t.parsedType}),Lt}const t=new Vt;let r;for(const s of this._def.checks)if("min"===s.kind)e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("max"===s.kind)e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("length"===s.kind){const a=e.data.length>s.value,n=e.data.length<s.value;(a||n)&&(r=this._getOrReturnCtx(e,r),a?Ut(r,{code:It.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):n&&Ut(r,{code:It.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),t.dirty())}else if("email"===s.kind)nr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"email",code:It.invalid_string,message:s.message}),t.dirty());else if("emoji"===s.kind)ir||(ir=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ir.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"emoji",code:It.invalid_string,message:s.message}),t.dirty());else if("uuid"===s.kind)tr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"uuid",code:It.invalid_string,message:s.message}),t.dirty());else if("nanoid"===s.kind)rr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"nanoid",code:It.invalid_string,message:s.message}),t.dirty());else if("cuid"===s.kind)Xt.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"cuid",code:It.invalid_string,message:s.message}),t.dirty());else if("cuid2"===s.kind)Qt.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"cuid2",code:It.invalid_string,message:s.message}),t.dirty());else if("ulid"===s.kind)er.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"ulid",code:It.invalid_string,message:s.message}),t.dirty());else if("url"===s.kind)try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Ut(r,{validation:"url",code:It.invalid_string,message:s.message}),t.dirty()}else if("regex"===s.kind){s.regex.lastIndex=0;s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"regex",code:It.invalid_string,message:s.message}),t.dirty())}else if("trim"===s.kind)e.data=e.data.trim();else if("includes"===s.kind)e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),t.dirty());else if("toLowerCase"===s.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===s.kind)e.data=e.data.toUpperCase();else if("startsWith"===s.kind)e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:{startsWith:s.value},message:s.message}),t.dirty());else if("endsWith"===s.kind)e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:{endsWith:s.value},message:s.message}),t.dirty());else if("datetime"===s.kind){yr(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:"datetime",message:s.message}),t.dirty())}else if("date"===s.kind){pr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:"date",message:s.message}),t.dirty())}else if("time"===s.kind){gr(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.invalid_string,validation:"time",message:s.message}),t.dirty())}else"duration"===s.kind?ar.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"duration",code:It.invalid_string,message:s.message}),t.dirty()):"ip"===s.kind?vr(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"ip",code:It.invalid_string,message:s.message}),t.dirty()):"jwt"===s.kind?br(e.data,s.alg)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"jwt",code:It.invalid_string,message:s.message}),t.dirty()):"cidr"===s.kind?wr(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"cidr",code:It.invalid_string,message:s.message}),t.dirty()):"base64"===s.kind?dr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"base64",code:It.invalid_string,message:s.message}),t.dirty()):"base64url"===s.kind?hr.test(e.data)||(r=this._getOrReturnCtx(e,r),Ut(r,{validation:"base64url",code:It.invalid_string,message:s.message}),t.dirty()):jt.assertNever(s);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:It.invalid_string,...Wt.errToObj(r)})}_addCheck(e){return new _r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Wt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Wt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Wt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Wt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Wt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Wt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Wt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Wt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Wt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Wt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Wt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Wt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Wt.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:(null==e?void 0:e.offset)??!1,local:(null==e?void 0:e.local)??!1,...Wt.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Wt.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Wt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Wt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...Wt.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Wt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Wt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Wt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Wt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Wt.errToObj(t)})}nonempty(e){return this.min(1,Wt.errToObj(e))}trim(){return new _r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function kr(e,t){const r=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,a=r>s?r:s;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}_r.create=e=>new _r({checks:[],typeName:as.ZodString,coerce:(null==e?void 0:e.coerce)??!1,...Gt(e)});class xr extends Yt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==Ct.number){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.number,received:t.parsedType}),Lt}let t;const r=new Vt;for(const s of this._def.checks)if("int"===s.kind)jt.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty());else if("min"===s.kind){(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty())}else if("max"===s.kind){(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty())}else"multipleOf"===s.kind?0!==kr(e.data,s.value)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.not_finite,message:s.message}),r.dirty()):jt.assertNever(s);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Wt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Wt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Wt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Wt.toString(t))}setLimit(e,t,r,s){return new xr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Wt.toString(s)}]})}_addCheck(e){return new xr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Wt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Wt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Wt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Wt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Wt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Wt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Wt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Wt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Wt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&jt.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}xr.create=e=>new xr({checks:[],typeName:as.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Gt(e)});class Sr extends Yt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Ct.bigint)return this._getInvalidInput(e);let t;const r=new Vt;for(const s of this._def.checks)if("min"===s.kind){(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty())}else if("max"===s.kind){(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty())}else"multipleOf"===s.kind?e.data%s.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Ut(t,{code:It.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):jt.assertNever(s);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.bigint,received:t.parsedType}),Lt}gte(e,t){return this.setLimit("min",e,!0,Wt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Wt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Wt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Wt.toString(t))}setLimit(e,t,r,s){return new Sr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Wt.toString(s)}]})}_addCheck(e){return new Sr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Wt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Wt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Wt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Wt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Wt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Sr.create=e=>new Sr({checks:[],typeName:as.ZodBigInt,coerce:(null==e?void 0:e.coerce)??!1,...Gt(e)});class Er extends Yt{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==Ct.boolean){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.boolean,received:t.parsedType}),Lt}return Bt(e.data)}}Er.create=e=>new Er({typeName:as.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Gt(e)});class Tr extends Yt{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==Ct.date){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.date,received:t.parsedType}),Lt}if(Number.isNaN(e.data.getTime())){return Ut(this._getOrReturnCtx(e),{code:It.invalid_date}),Lt}const t=new Vt;let r;for(const s of this._def.checks)"min"===s.kind?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),t.dirty()):"max"===s.kind?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),Ut(r,{code:It.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),t.dirty()):jt.assertNever(s);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Tr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Wt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Wt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Tr.create=e=>new Tr({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:as.ZodDate,...Gt(e)});class Or extends Yt{_parse(e){if(this._getType(e)!==Ct.symbol){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.symbol,received:t.parsedType}),Lt}return Bt(e.data)}}Or.create=e=>new Or({typeName:as.ZodSymbol,...Gt(e)});class jr extends Yt{_parse(e){if(this._getType(e)!==Ct.undefined){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.undefined,received:t.parsedType}),Lt}return Bt(e.data)}}jr.create=e=>new jr({typeName:as.ZodUndefined,...Gt(e)});class Ar extends Yt{_parse(e){if(this._getType(e)!==Ct.null){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.null,received:t.parsedType}),Lt}return Bt(e.data)}}Ar.create=e=>new Ar({typeName:as.ZodNull,...Gt(e)});class Rr extends Yt{constructor(){super(...arguments),this._any=!0}_parse(e){return Bt(e.data)}}Rr.create=e=>new Rr({typeName:as.ZodAny,...Gt(e)});class Cr extends Yt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Bt(e.data)}}Cr.create=e=>new Cr({typeName:as.ZodUnknown,...Gt(e)});class Nr extends Yt{_parse(e){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.never,received:t.parsedType}),Lt}}Nr.create=e=>new Nr({typeName:as.ZodNever,...Gt(e)});class Ir extends Yt{_parse(e){if(this._getType(e)!==Ct.undefined){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.void,received:t.parsedType}),Lt}return Bt(e.data)}}Ir.create=e=>new Ir({typeName:as.ZodVoid,...Gt(e)});class $r extends Yt{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==Ct.array)return Ut(t,{code:It.invalid_type,expected:Ct.array,received:t.parsedType}),Lt;if(null!==s.exactLength){const e=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(e||a)&&(Ut(t,{code:e?It.too_big:It.too_small,minimum:a?s.exactLength.value:void 0,maximum:e?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(null!==s.minLength&&t.data.length<s.minLength.value&&(Ut(t,{code:It.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),null!==s.maxLength&&t.data.length>s.maxLength.value&&(Ut(t,{code:It.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>s.type._parseAsync(new Jt(t,e,t.path,r)))).then(e=>Vt.mergeArray(r,e));const a=[...t.data].map((e,r)=>s.type._parseSync(new Jt(t,e,t.path,r)));return Vt.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new $r({...this._def,minLength:{value:e,message:Wt.toString(t)}})}max(e,t){return new $r({...this._def,maxLength:{value:e,message:Wt.toString(t)}})}length(e,t){return new $r({...this._def,exactLength:{value:e,message:Wt.toString(t)}})}nonempty(e){return this.min(1,e)}}function Pr(e){if(e instanceof Dr){const t={};for(const r in e.shape){const s=e.shape[r];t[r]=Gr.create(Pr(s))}return new Dr({...e._def,shape:()=>t})}return e instanceof $r?new $r({...e._def,type:Pr(e.element)}):e instanceof Gr?Gr.create(Pr(e.unwrap())):e instanceof Yr?Yr.create(Pr(e.unwrap())):e instanceof Fr?Fr.create(e.items.map(e=>Pr(e))):e}$r.create=(e,t)=>new $r({type:e,minLength:null,maxLength:null,exactLength:null,typeName:as.ZodArray,...Gt(t)});class Dr extends Yt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=jt.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==Ct.object){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.object,received:t.parsedType}),Lt}const{status:t,ctx:r}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),n=[];if(!(this._def.catchall instanceof Nr&&"strip"===this._def.unknownKeys))for(const o in r.data)a.includes(o)||n.push(o);const i=[];for(const o of a){const e=s[o],t=r.data[o];i.push({key:{status:"valid",value:o},value:e._parse(new Jt(r,t,r.path,o)),alwaysSet:o in r.data})}if(this._def.catchall instanceof Nr){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of n)i.push({key:{status:"valid",value:t},value:{status:"valid",value:r.data[t]}});else if("strict"===e)n.length>0&&(Ut(r,{code:It.unrecognized_keys,keys:n}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of n){const s=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new Jt(r,s,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of i){const r=await t.key,s=await t.value;e.push({key:r,value:s,alwaysSet:t.alwaysSet})}return e}).then(e=>Vt.mergeObjectSync(t,e)):Vt.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return Wt.errToObj,new Dr({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var s,a;const n=(null==(a=(s=this._def).errorMap)?void 0:a.call(s,t,r).message)??r.defaultError;return"unrecognized_keys"===t.code?{message:Wt.errToObj(e).message??n}:{message:n}}}:{}})}strip(){return new Dr({...this._def,unknownKeys:"strip"})}passthrough(){return new Dr({...this._def,unknownKeys:"passthrough"})}extend(e){return new Dr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Dr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:as.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Dr({...this._def,catchall:e})}pick(e){const t={};for(const r of jt.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new Dr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of jt.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new Dr({...this._def,shape:()=>t})}deepPartial(){return Pr(this)}partial(e){const t={};for(const r of jt.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new Dr({...this._def,shape:()=>t})}required(e){const t={};for(const r of jt.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Gr;)e=e._def.innerType;t[r]=e}return new Dr({...this._def,shape:()=>t})}keyof(){return Kr(jt.objectKeys(this.shape))}}Dr.create=(e,t)=>new Dr({shape:()=>e,unknownKeys:"strip",catchall:Nr.create(),typeName:as.ZodObject,...Gt(t)}),Dr.strictCreate=(e,t)=>new Dr({shape:()=>e,unknownKeys:"strict",catchall:Nr.create(),typeName:as.ZodObject,...Gt(t)}),Dr.lazycreate=(e,t)=>new Dr({shape:e,unknownKeys:"strip",catchall:Nr.create(),typeName:as.ZodObject,...Gt(t)});class Ur extends Yt{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const s of e)if("dirty"===s.result.status)return t.common.issues.push(...s.ctx.common.issues),s.result;const r=e.map(e=>new $t(e.ctx.common.issues));return Ut(t,{code:It.invalid_union,unionErrors:r}),Lt});{let e;const s=[];for(const n of r){const r={...t,common:{...t.common,issues:[]},parent:null},a=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:r}),r.common.issues.length&&s.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=s.map(e=>new $t(e));return Ut(t,{code:It.invalid_union,unionErrors:a}),Lt}}get options(){return this._def.options}}function Vr(e,t){const r=Nt(e),s=Nt(t);if(e===t)return{valid:!0,data:e};if(r===Ct.object&&s===Ct.object){const r=jt.objectKeys(t),s=jt.objectKeys(e).filter(e=>-1!==r.indexOf(e)),a={...e,...t};for(const n of s){const r=Vr(e[n],t[n]);if(!r.valid)return{valid:!1};a[n]=r.data}return{valid:!0,data:a}}if(r===Ct.array&&s===Ct.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let s=0;s<e.length;s++){const a=Vr(e[s],t[s]);if(!a.valid)return{valid:!1};r.push(a.data)}return{valid:!0,data:r}}return r===Ct.date&&s===Ct.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}Ur.create=(e,t)=>new Ur({options:e,typeName:as.ZodUnion,...Gt(t)});class Lr extends Yt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(e,s)=>{if(qt(e)||qt(s))return Lt;const a=Vr(e.value,s.value);return a.valid?((Mt(e)||Mt(s))&&t.dirty(),{status:t.value,value:a.data}):(Ut(r,{code:It.invalid_intersection_types}),Lt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>s(e,t)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Lr.create=(e,t,r)=>new Lr({left:e,right:t,typeName:as.ZodIntersection,...Gt(r)});class Fr extends Yt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ct.array)return Ut(r,{code:It.invalid_type,expected:Ct.array,received:r.parsedType}),Lt;if(r.data.length<this._def.items.length)return Ut(r,{code:It.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Lt;!this._def.rest&&r.data.length>this._def.items.length&&(Ut(r,{code:It.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((e,t)=>{const s=this._def.items[t]||this._def.rest;return s?s._parse(new Jt(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(s).then(e=>Vt.mergeArray(t,e)):Vt.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new Fr({...this._def,rest:e})}}Fr.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Fr({items:e,typeName:as.ZodTuple,rest:null,...Gt(t)})};class Br extends Yt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ct.map)return Ut(r,{code:It.invalid_type,expected:Ct.map,received:r.parsedType}),Lt;const s=this._def.keyType,a=this._def.valueType,n=[...r.data.entries()].map(([e,t],n)=>({key:s._parse(new Jt(r,e,r.path,[n,"key"])),value:a._parse(new Jt(r,t,r.path,[n,"value"]))}));if(r.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const r of n){const s=await r.key,a=await r.value;if("aborted"===s.status||"aborted"===a.status)return Lt;"dirty"!==s.status&&"dirty"!==a.status||t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}})}{const e=new Map;for(const r of n){const s=r.key,a=r.value;if("aborted"===s.status||"aborted"===a.status)return Lt;"dirty"!==s.status&&"dirty"!==a.status||t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}}}}Br.create=(e,t,r)=>new Br({valueType:t,keyType:e,typeName:as.ZodMap,...Gt(r)});class qr extends Yt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ct.set)return Ut(r,{code:It.invalid_type,expected:Ct.set,received:r.parsedType}),Lt;const s=this._def;null!==s.minSize&&r.data.size<s.minSize.value&&(Ut(r,{code:It.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),null!==s.maxSize&&r.data.size>s.maxSize.value&&(Ut(r,{code:It.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function n(e){const r=new Set;for(const s of e){if("aborted"===s.status)return Lt;"dirty"===s.status&&t.dirty(),r.add(s.value)}return{status:t.value,value:r}}const i=[...r.data.values()].map((e,t)=>a._parse(new Jt(r,e,r.path,t)));return r.common.async?Promise.all(i).then(e=>n(e)):n(i)}min(e,t){return new qr({...this._def,minSize:{value:e,message:Wt.toString(t)}})}max(e,t){return new qr({...this._def,maxSize:{value:e,message:Wt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}qr.create=(e,t)=>new qr({valueType:e,minSize:null,maxSize:null,typeName:as.ZodSet,...Gt(t)});class Mr extends Yt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Mr.create=(e,t)=>new Mr({getter:e,typeName:as.ZodLazy,...Gt(t)});class zr extends Yt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ut(t,{received:t.data,code:It.invalid_literal,expected:this._def.value}),Lt}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Kr(e,t){return new Wr({values:e,typeName:as.ZodEnum,...Gt(t)})}zr.create=(e,t)=>new zr({value:e,typeName:as.ZodLiteral,...Gt(t)});class Wr extends Yt{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return Ut(t,{expected:jt.joinValues(r),received:t.parsedType,code:It.invalid_type}),Lt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return Ut(t,{received:t.data,code:It.invalid_enum_value,options:r}),Lt}return Bt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Wr.create(e,{...this._def,...t})}exclude(e,t=this._def){return Wr.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}Wr.create=Kr;class Zr extends Yt{_parse(e){const t=jt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ct.string&&r.parsedType!==Ct.number){const e=jt.objectValues(t);return Ut(r,{expected:jt.joinValues(e),received:r.parsedType,code:It.invalid_type}),Lt}if(this._cache||(this._cache=new Set(jt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=jt.objectValues(t);return Ut(r,{received:r.data,code:It.invalid_enum_value,options:e}),Lt}return Bt(e.data)}get enum(){return this._def.values}}Zr.create=(e,t)=>new Zr({values:e,typeName:as.ZodNativeEnum,...Gt(t)});class Jr extends Yt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ct.promise&&!1===t.common.async)return Ut(t,{code:It.invalid_type,expected:Ct.promise,received:t.parsedType}),Lt;const r=t.parsedType===Ct.promise?t.data:Promise.resolve(t.data);return Bt(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Jr.create=(e,t)=>new Jr({type:e,typeName:as.ZodPromise,...Gt(t)});class Hr extends Yt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===as.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:e=>{Ut(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===s.type){const e=s.transform(r.data,a);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return Lt;const s=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===s.status?Lt:"dirty"===s.status||"dirty"===t.value?Ft(s.value):s});{if("aborted"===t.value)return Lt;const s=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===s.status?Lt:"dirty"===s.status||"dirty"===t.value?Ft(s.value):s}}if("refinement"===s.type){const e=e=>{const t=s.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===s.status?Lt:("dirty"===s.status&&t.dirty(),e(s.value),{status:t.value,value:s.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?Lt:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===s.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!zt(e))return Lt;const n=s.transform(e.value,a);if(n instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:n}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>zt(e)?Promise.resolve(s.transform(e.value,a)).then(e=>({status:t.value,value:e})):Lt)}jt.assertNever(s)}}Hr.create=(e,t,r)=>new Hr({schema:e,typeName:as.ZodEffects,effect:t,...Gt(r)}),Hr.createWithPreprocess=(e,t,r)=>new Hr({schema:t,effect:{type:"preprocess",transform:e},typeName:as.ZodEffects,...Gt(r)});class Gr extends Yt{_parse(e){return this._getType(e)===Ct.undefined?Bt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Gr.create=(e,t)=>new Gr({innerType:e,typeName:as.ZodOptional,...Gt(t)});class Yr extends Yt{_parse(e){return this._getType(e)===Ct.null?Bt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Yr.create=(e,t)=>new Yr({innerType:e,typeName:as.ZodNullable,...Gt(t)});class Xr extends Yt{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===Ct.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Xr.create=(e,t)=>new Xr({innerType:e,typeName:as.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Gt(t)});class Qr extends Yt{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Kt(s)?s.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new $t(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new $t(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Qr.create=(e,t)=>new Qr({innerType:e,typeName:as.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Gt(t)});class es extends Yt{_parse(e){if(this._getType(e)!==Ct.nan){const t=this._getOrReturnCtx(e);return Ut(t,{code:It.invalid_type,expected:Ct.nan,received:t.parsedType}),Lt}return{status:"valid",value:e.data}}}es.create=e=>new es({typeName:as.ZodNaN,...Gt(e)});class ts extends Yt{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class rs extends Yt{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?Lt:"dirty"===e.status?(t.dirty(),Ft(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?Lt:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new rs({in:e,out:t,typeName:as.ZodPipeline})}}class ss extends Yt{_parse(e){const t=this._def.innerType._parse(e),r=e=>(zt(e)&&(e.value=Object.freeze(e.value)),e);return Kt(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}var as,ns;ss.create=(e,t)=>new ss({innerType:e,typeName:as.ZodReadonly,...Gt(t)}),(ns=as||(as={})).ZodString="ZodString",ns.ZodNumber="ZodNumber",ns.ZodNaN="ZodNaN",ns.ZodBigInt="ZodBigInt",ns.ZodBoolean="ZodBoolean",ns.ZodDate="ZodDate",ns.ZodSymbol="ZodSymbol",ns.ZodUndefined="ZodUndefined",ns.ZodNull="ZodNull",ns.ZodAny="ZodAny",ns.ZodUnknown="ZodUnknown",ns.ZodNever="ZodNever",ns.ZodVoid="ZodVoid",ns.ZodArray="ZodArray",ns.ZodObject="ZodObject",ns.ZodUnion="ZodUnion",ns.ZodDiscriminatedUnion="ZodDiscriminatedUnion",ns.ZodIntersection="ZodIntersection",ns.ZodTuple="ZodTuple",ns.ZodRecord="ZodRecord",ns.ZodMap="ZodMap",ns.ZodSet="ZodSet",ns.ZodFunction="ZodFunction",ns.ZodLazy="ZodLazy",ns.ZodLiteral="ZodLiteral",ns.ZodEnum="ZodEnum",ns.ZodEffects="ZodEffects",ns.ZodNativeEnum="ZodNativeEnum",ns.ZodOptional="ZodOptional",ns.ZodNullable="ZodNullable",ns.ZodDefault="ZodDefault",ns.ZodCatch="ZodCatch",ns.ZodPromise="ZodPromise",ns.ZodBranded="ZodBranded",ns.ZodPipeline="ZodPipeline",ns.ZodReadonly="ZodReadonly";const is=_r.create;Nr.create,$r.create;const os=Dr.create;Ur.create,Lr.create,Fr.create,Wr.create,Jr.create,Gr.create,Yr.create;class ls extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class cs extends ls{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class us extends ls{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ds extends ls{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var hs,fs;(fs=hs||(hs={})).Any="any",fs.ApNortheast1="ap-northeast-1",fs.ApNortheast2="ap-northeast-2",fs.ApSouth1="ap-south-1",fs.ApSoutheast1="ap-southeast-1",fs.ApSoutheast2="ap-southeast-2",fs.CaCentral1="ca-central-1",fs.EuCentral1="eu-central-1",fs.EuWest1="eu-west-1",fs.EuWest2="eu-west-2",fs.EuWest3="eu-west-3",fs.SaEast1="sa-east-1",fs.UsEast1="us-east-1",fs.UsWest1="us-west-1",fs.UsWest2="us-west-2";class ps{constructor(e,{headers:t={},customFetch:r,region:s=hs.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return o(this,arguments,void 0,function*(e,t={}){var r;let s,a;try{const{headers:n,method:i,body:o,signal:l,timeout:c}=t;let u={},{region:d}=t;d||(d=this.region);const h=new URL(`${this.url}/${e}`);let f;d&&"any"!==d&&(u["x-region"]=d,h.searchParams.set("forceFunctionRegion",d)),o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)?"undefined"!=typeof Blob&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",f=o):"string"==typeof o?(u["Content-Type"]="text/plain",f=o):"undefined"!=typeof FormData&&o instanceof FormData?f=o:(u["Content-Type"]="application/json",f=JSON.stringify(o)):f=!o||"string"==typeof o||"undefined"!=typeof Blob&&o instanceof Blob||o instanceof ArrayBuffer||"undefined"!=typeof FormData&&o instanceof FormData?o:JSON.stringify(o);let p=l;c&&(a=new AbortController,s=setTimeout(()=>a.abort(),c),l?(p=a.signal,l.addEventListener("abort",()=>a.abort())):p=a.signal);const m=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),n),body:f,signal:p}).catch(e=>{throw new cs(e)}),g=m.headers.get("x-relay-error");if(g&&"true"===g)throw new us(m);if(!m.ok)throw new ds(m);let y,v=(null!==(r=m.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return y="application/json"===v?yield m.json():"application/octet-stream"===v||"application/pdf"===v?yield m.blob():"text/event-stream"===v?m:"multipart/form-data"===v?yield m.formData():yield m.text(),{data:y,error:null,response:m}}catch(n){return{data:null,error:n,response:n instanceof ds||n instanceof us?n.context:void 0}}finally{s&&clearTimeout(s)}})}}var ms=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},gs=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,s=null,a=null,n=e.status,i=e.statusText;if(e.ok){var o,l;if("HEAD"!==r.method){var c;const t=await e.text();""===t||(s="text/csv"===r.headers.get("Accept")||r.headers.get("Accept")&&(null===(c=r.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const u=null===(o=r.headers.get("Prefer"))||void 0===o?void 0:o.match(/count=(exact|planned|estimated)/),d=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");u&&d&&d.length>1&&(a=parseInt(d[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(s)&&(s.length>1?(t={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,a=null,n=406,i="Not Acceptable"):s=1===s.length?s[0]:null)}else{var u;const a=await e.text();try{t=JSON.parse(a),Array.isArray(t)&&404===e.status&&(s=[],t=null,n=200,i="OK")}catch(d){404===e.status&&""===a?(n=204,i="No Content"):t={message:a}}if(t&&r.isMaybeSingle&&(null==t||null===(u=t.details)||void 0===u?void 0:u.includes("0 rows"))&&(t=null,n=200,i="OK"),t&&r.shouldThrowOnError)throw new ms(t)}return{error:t,data:s,count:a,status:n,statusText:i}});return this.shouldThrowOnError||(s=s.catch(e=>{var t;let r="";const s=null==e?void 0:e.cause;if(s){var a,n,i,o;const t=null!==(a=null==s?void 0:s.message)&&void 0!==a?a:"",l=null!==(n=null==s?void 0:s.code)&&void 0!==n?n:"";r=`${null!==(i=null==e?void 0:e.name)&&void 0!==i?i:"FetchError"}: ${null==e?void 0:e.message}`,r+=`\n\nCaused by: ${null!==(o=null==s?void 0:s.name)&&void 0!==o?o:"Error"}: ${t}`,l&&(r+=` (${l})`),(null==s?void 0:s.stack)&&(r+=`\n${s.stack}`)}else{var l;r=null!==(l=null==e?void 0:e.stack)&&void 0!==l?l:""}return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:r,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},ys=class extends gs{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const n=a?`${a}.order`:"order",i=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=void 0===s?"offset":`${s}.offset`,n=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:n="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const vs=new RegExp("[,()]");var bs=class extends ys{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&vs.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&vs.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";"plain"===s?a="pl":"phrase"===s?a="ph":"websearch"===s&&(a="w");const n=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},ws=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=null!=t?t:{},a=r?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",i),s&&l.append("Prefer",`count=${s}`),new bs({method:a,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const{url:a,headers:n}=this.cloneRequestState();if(t&&n.append("Prefer",`count=${t}`),r||n.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);a.searchParams.set("columns",e.join(","))}}return new bs({method:"POST",url:a,headers:n,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var n;const{url:i,headers:o}=this.cloneRequestState();if(o.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&i.searchParams.set("on_conflict",t),s&&o.append("Prefer",`count=${s}`),a||o.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);i.searchParams.set("columns",e.join(","))}}return new bs({method:"POST",url:i,headers:o,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}update(e,{count:t}={}){var r;const{url:s,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new bs({method:"PATCH",url:s,headers:a,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;const{url:r,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new bs({method:"DELETE",url:r,headers:s,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},_s=class e{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){if(!e||"string"!=typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new ws(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:a}={}){var n;let i;const o=new URL(`${this.url}/rpc/${e}`);let l;const c=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(c)),u=r&&Object.values(t).some(c);u?(i="POST",l=t):r||s?(i=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{o.searchParams.append(e,t)})):(i="POST",l=t);const d=new Headers(this.headers);return u?d.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&d.set("Prefer",`count=${a}`),new bs({method:i,url:o,headers:d,schema:this.schemaName,body:l,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}};class ks{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const xs="1.0.0",Ss=xs,Es=1e4;var Ts,Os,js,As,Rs,Cs,Ns,Is,$s,Ps,Ds;(Os=Ts||(Ts={}))[Os.connecting=0]="connecting",Os[Os.open=1]="open",Os[Os.closing=2]="closing",Os[Os.closed=3]="closed",(As=js||(js={})).closed="closed",As.errored="errored",As.joined="joined",As.joining="joining",As.leaving="leaving",(Cs=Rs||(Rs={})).close="phx_close",Cs.error="phx_error",Cs.join="phx_join",Cs.reply="phx_reply",Cs.leave="phx_leave",Cs.access_token="access_token",(Ns||(Ns={})).websocket="websocket",($s=Is||(Is={})).Connecting="connecting",$s.Open="open",$s.Closing="closing",$s.Closed="closed";class Us{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"==typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const s=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,r;const s=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:{},a=(new TextEncoder).encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,r){var s,a;const n=e.topic,i=null!==(s=e.ref)&&void 0!==s?s:"",o=null!==(a=e.join_ref)&&void 0!==a?a:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=0===Object.keys(c).length?"":JSON.stringify(c);if(o.length>255)throw new Error(`joinRef length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`ref length ${i.length} exceeds maximum of 255`);if(n.length>255)throw new Error(`topic length ${n.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`metadata length ${u.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+i.length+n.length+l.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let f=new DataView(h),p=0;f.setUint8(p++,this.KINDS.userBroadcastPush),f.setUint8(p++,o.length),f.setUint8(p++,i.length),f.setUint8(p++,n.length),f.setUint8(p++,l.length),f.setUint8(p++,u.length),f.setUint8(p++,t),Array.from(o,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(i,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(n,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(l,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(u,e=>f.setUint8(p++,e.charCodeAt(0)));var m=new Uint8Array(h.byteLength+r.byteLength);return m.set(new Uint8Array(h),0),m.set(new Uint8Array(r),h.byteLength),m.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"==typeof e){const r=JSON.parse(e),[s,a,n,i,o]=r;return t({join_ref:s,ref:a,topic:n,event:i,payload:o})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),n=t.getUint8(3),i=t.getUint8(4);let o=this.HEADER_LENGTH+4;const l=r.decode(e.slice(o,o+s));o+=s;const c=r.decode(e.slice(o,o+a));o+=a;const u=r.decode(e.slice(o,o+n));o+=n;const d=e.slice(o,e.byteLength),h=i===this.JSON_ENCODING?JSON.parse(r.decode(d)):d,f={type:this.BROADCAST_EVENT,event:c,payload:h};return n>0&&(f.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class Vs{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Ds=Ps||(Ps={})).abstime="abstime",Ds.bool="bool",Ds.date="date",Ds.daterange="daterange",Ds.float4="float4",Ds.float8="float8",Ds.int2="int2",Ds.int4="int4",Ds.int4range="int4range",Ds.int8="int8",Ds.int8range="int8range",Ds.json="json",Ds.jsonb="jsonb",Ds.money="money",Ds.numeric="numeric",Ds.oid="oid",Ds.reltime="reltime",Ds.text="text",Ds.time="time",Ds.timestamp="timestamp",Ds.timestamptz="timestamptz",Ds.timetz="timetz",Ds.tsrange="tsrange",Ds.tstzrange="tstzrange";const Ls=(e,t,r={})=>{var s;const a=null!==(s=r.skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=Fs(s,e,t,a),r),{}):{}},Fs=(e,t,r,s)=>{const a=t.find(t=>t.name===e),n=null==a?void 0:a.type,i=r[e];return n&&!s.includes(n)?Bs(n,i):qs(i)},Bs=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Ws(t,r)}switch(e){case Ps.bool:return Ms(t);case Ps.float4:case Ps.float8:case Ps.int2:case Ps.int4:case Ps.int8:case Ps.numeric:case Ps.oid:return zs(t);case Ps.json:case Ps.jsonb:return Ks(t);case Ps.timestamp:return Zs(t);case Ps.abstime:case Ps.date:case Ps.daterange:case Ps.int4range:case Ps.int8range:case Ps.money:case Ps.reltime:case Ps.text:case Ps.time:case Ps.timestamptz:case Ps.timetz:case Ps.tsrange:case Ps.tstzrange:default:return qs(t)}},qs=e=>e,Ms=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},zs=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ks=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Ws=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s;const n=e.slice(1,r);try{s=JSON.parse("["+n+"]")}catch(a){s=n?n.split(","):[]}return s.map(e=>Bs(t,e))}return e},Zs=e=>"string"==typeof e?e.replace(" ","T"):e,Js=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Hs{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Gs,Ys,Xs,Qs,ea,ta,ra,sa;(Ys=Gs||(Gs={})).SYNC="sync",Ys.JOIN="join",Ys.LEAVE="leave";class aa{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=aa.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=aa.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=aa.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),n=this.transformState(t),i={},o={};return this.map(a,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{const r=a[e];if(r){const s=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),n=t.filter(e=>a.indexOf(e.presence_ref)<0),l=r.filter(e=>s.indexOf(e.presence_ref)<0);n.length>0&&(i[e]=n),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:o},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(t,s)=>{var a;const n=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(s),n.length>0){const r=e[t].map(e=>e.presence_ref),s=n.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...s)}r(t,n,s)}),this.map(n,(t,r)=>{let a=e[t];if(!a)return;const n=r.map(e=>e.presence_ref);a=a.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=a,s(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return t[r]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Qs=Xs||(Xs={})).ALL="*",Qs.INSERT="INSERT",Qs.UPDATE="UPDATE",Qs.DELETE="DELETE",(ta=ea||(ea={})).BROADCAST="broadcast",ta.PRESENCE="presence",ta.POSTGRES_CHANGES="postgres_changes",ta.SYSTEM="system",(sa=ra||(ra={})).SUBSCRIBED="SUBSCRIBED",sa.TIMED_OUT="TIMED_OUT",sa.CLOSED="CLOSED",sa.CHANNEL_ERROR="CHANNEL_ERROR";class na{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=js.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Hs(this,Rs.join,this.params,this.timeout),this.rejoinTimer=new Vs(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=js.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=js.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rs.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new aa(this),this.broadcastEndpointURL=Js(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(a=null===(s=this.params.config)||void 0===s?void 0:s.broadcast)||void 0===a?void 0:a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==js.closed){const{config:{broadcast:n,presence:i,private:o}}=this.params,l=null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[],c=!!this.bindings[ea.PRESENCE]&&this.bindings[ea.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),u={},d={broadcast:n,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(ra.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(ra.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==t){const s=this.bindings.postgres_changes,a=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,n=[];for(let r=0;r<a;r++){const a=s[r],{filter:{event:i,schema:o,table:l,filter:c}}=a,u=t&&t[r];if(!(u&&u.event===i&&na.isFilterValueEqual(u.schema,o)&&na.isFilterValueEqual(u.table,l)&&na.isFilterValueEqual(u.filter,c)))return this.unsubscribe(),this.state=js.errored,void(null==e||e(ra.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},a),{id:u.id}))}return this.bindings.postgres_changes=n,void(e&&e(ra.SUBSCRIBED))}null==e||e(ra.SUBSCRIBED)}).receive("error",t=>{this.state=js.errored,null==e||e(ra.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(ra.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===js.joined&&e===ea.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;if(null==t)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const n={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!==(s=r.timeout)&&void 0!==s?s:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{const e=await i.json();o=e.error||e.message||o}catch(l){}return Promise.reject(new Error(o))}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,a,n;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(a=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===a?void 0:a.broadcast)||void 0===n?void 0:n.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{const{event:n,payload:i}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=js.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rs.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Hs(this,Rs.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=js.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),n}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Hs(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const n=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=Rs;if(r&&[i,o,l,c].indexOf(n)>=0&&r!==this._joinRef())return;let u=this._onMessage(n,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===n}).map(e=>e.callback(u,r)):null===(a=this.bindings[n])||void 0===a||a.filter(e=>{var r,s,a,i,o,l,c,u;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,l=null===(r=e.filter)||void 0===r?void 0:r.event;return n&&(null===(s=t.ids)||void 0===s?void 0:s.includes(n))&&("*"===l||(null==l?void 0:l.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))&&(!(null===(i=e.filter)||void 0===i?void 0:i.table)||e.filter.table===(null===(o=t.data)||void 0===o?void 0:o.table))}{const r=null===(c=null===(l=null==e?void 0:e.filter)||void 0===l?void 0:l.event)||void 0===c?void 0:c.toLocaleLowerCase();return"*"===r||r===(null===(u=null==t?void 0:t.event)||void 0===u?void 0:u.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:s,type:a,errors:n}=e,i={schema:t,table:r,commit_timestamp:s,eventType:a,new:{},old:{},errors:n};u=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===js.closed}_isJoined(){return this.state===js.joined}_isJoining(){return this.state===js.joining}_isLeaving(){return this.state===js.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&na.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Rs.close,{},e)}_onError(e){this._on(Rs.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=js.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ls(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ls(e.columns,e.old_record)),t}}const ia=()=>{},oa=25e3,la=10,ca=100,ua=[1e3,2e3,5e3,1e4];class da{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Es,this.transport=null,this.heartbeatIntervalMs=oa,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ia,this.ref=0,this.reconnectTimer=null,this.vsn=Ss,this.logger=ia,this.conn=null,this.sendBuffer=[],this.serializer=new Us,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ns.websocket}`,this.httpEndpoint=Js(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ks.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ts.connecting:return Is.Connecting;case Ts.open:return Is.Open;case Ts.closing:return Is.Closing;default:return Is.Closed}}isConnected(){return this.connectionState()===Is.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{const r=new na(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},ca)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(o){this.log("error","error in heartbeat callback",o)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:r,payload:s,ref:a}=e,n=a?`(${a})`:"",i=s.status||"";this.log("receive",`${i} ${t} ${r} ${n}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ts.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ts.open||this.conn.readyState===Ts.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`);(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Rs.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.90.1"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(Rs.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Vs(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},la)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,n,i,o,l,c,u,d,h;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:Es,this.heartbeatIntervalMs=null!==(s=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:oa,this.worker=null!==(a=null==e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(i=null==e?void 0:e.heartbeatCallback)&&void 0!==i?i:ia,this.vsn=null!==(o=null==e?void 0:e.vsn)&&void 0!==o?o:Ss,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>ua[e-1]||1e4,this.vsn){case xs:this.encode=null!==(c=null==e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null==e?void 0:e.decode)&&void 0!==u?u:(e,t)=>t(JSON.parse(e));break;case"2.0.0":this.encode=null!==(d=null==e?void 0:e.encode)&&void 0!==d?d:this.serializer.encode.bind(this.serializer),this.decode=null!==(h=null==e?void 0:e.decode)&&void 0!==h?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var ha=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null==(r=t.icebergType)?void 0:r.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function fa(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:n,headers:i}){const o=function(e,t,r){const s=new URL(t,e);if(r)for(const[a,n]of Object.entries(r))void 0!==n&&s.searchParams.set(a,n);return s.toString()}(e.baseUrl,s,a),l=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),c=await t(o,{method:r,headers:{...n?{"Content-Type":"application/json"}:{},...l,...i},body:n?JSON.stringify(n):void 0}),u=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),h=d&&u?JSON.parse(u):u;if(!c.ok){const e=d?h:void 0,t=null==e?void 0:e.error;throw new ha((null==t?void 0:t.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:null==t?void 0:t.type,icebergCode:null==t?void 0:t.code,details:e})}return{status:c.status,headers:c.headers,data:h}}}}function pa(e){return e.join("")}var ma=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:pa(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:null==t?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${pa(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pa(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${pa(e.namespace)}`}),!0}catch(t){if(t instanceof ha&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof ha&&409===r.status)return;throw r}}};function ga(e){return e.join("")}var ya=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((null==t?void 0:t.purge)??!1)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ga(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof ha&&404===r.status)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof ha&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},va=class{constructor(e){var t;let r="v1";e.catalogName&&(r+=`/${e.catalogName}`);const s=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=fa({baseUrl:s,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null==(t=e.accessDelegation)?void 0:t.join(","),this.namespaceOps=new ma(this.client,r),this.tableOps=new ya(this.client,r,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},ba=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function wa(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var _a=class extends ba{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ka=class extends ba{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const xa=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),Sa=e=>{if(Array.isArray(e))return e.map(e=>Sa(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const s=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=Sa(r)}),t};function Ea(e){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ta(e){var t=function(e,t){if("object"!=Ea(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=Ea(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ea(t)?t:t+""}function Oa(e,t,r){return(t=Ta(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ja(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function Aa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(r),!0).forEach(function(t){Oa(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ja(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const Ra=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},Ca=async(e,t,r)=>{e instanceof await Response&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const s=e.status||500,a=(null==r?void 0:r.statusCode)||s+"";t(new _a(Ra(r),s,a))}).catch(e=>{t(new ka(Ra(e),e))}):t(new ka(Ra(e),e))},Na=(e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(a.headers=Aa({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,(null==t?void 0:t.duplex)&&(a.duplex=t.duplex),Aa(Aa({},a),r)):a};async function Ia(e,t,r,s,a,n){return new Promise((i,o)=>{e(r,Na(t,s,a,n)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>Ca(e,o,s))})}async function $a(e,t,r,s){return Ia(e,"GET",t,r,s)}async function Pa(e,t,r,s,a){return Ia(e,"POST",t,s,a,r)}async function Da(e,t,r,s,a){return Ia(e,"PUT",t,s,a,r)}async function Ua(e,t,r,s,a){return Ia(e,"DELETE",t,s,a,r)}var Va=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(wa(e))return{data:null,error:e};throw e}}};let La;La=Symbol.toStringTag;var Fa=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[La]="BlobDownloadBuilder",this.promise=null}asStream(){return new Va(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(wa(e))return{data:null,error:e};throw e}}};const Ba={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Ma=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=xa(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let n;const i=Aa(Aa({},qa),s);let o=Aa(Aa({},a.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const l=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),l&&n.append("metadata",a.encodeMetadata(l)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(n=r,n.has("cacheControl")||n.append("cacheControl",i.cacheControl),l&&!n.has("metadata")&&n.append("metadata",a.encodeMetadata(l))):(n=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&n instanceof ReadableStream||n&&"object"==typeof n&&"pipe"in n&&"function"==typeof n.pipe)&&!i.duplex&&(i.duplex="half")),(null==s?void 0:s.headers)&&(o=Aa(Aa({},o),s.headers));const c=a._removeEmptyFolders(t),u=a._getFinalPath(c),d=await("PUT"==e?Da:Pa)(a.fetch,`${a.url}/object/${u}`,n,Aa({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(wa(n))return{data:null,error:n};throw n}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const n=a._removeEmptyFolders(e),i=a._getFinalPath(n),o=new URL(a.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Aa({upsert:qa.upsert},s),i=Aa(Aa({},a.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType),{data:{path:n,fullPath:(await Da(a.fetch,o.toString(),e,{headers:i})).Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(wa(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=Aa({},r.headers);(null==t?void 0:t.upsert)&&(a["x-upsert"]="true");const n=await Pa(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),i=new URL(r.url+n.url),o=i.searchParams.get("token");if(!o)throw new ba("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(wa(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await Pa(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(wa(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await Pa(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(wa(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),n=await Pa(s.fetch,`${s.url}/object/sign/${a}`,Aa({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:s.headers});const i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return n={signedUrl:encodeURI(`${s.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(wa(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await Pa(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:a.map(e=>Aa(Aa({},e),{},{signedUrl:e.signedURL?encodeURI(`${s.url}${e.signedURL}${n}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(wa(a))return{data:null,error:a};throw a}}download(e,t){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=s?`?${s}`:"",n=this._getFinalPath(e);return new Fa(()=>$a(this.fetch,`${this.url}/${r}/${n}${a}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Sa(await $a(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(wa(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await async function(e,t,r,s){return Ia(e,"HEAD",t,Aa(Aa({},r),{},{noResolveJson:!0}),s)}(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(wa(s)&&s instanceof ka){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&s.push(a);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&s.push(i);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=Aa(Aa(Aa({},Ba),t),{},{prefix:e||""});return{data:await Pa(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(wa(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=Aa({},e);return{data:await Pa(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(wa(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const za="2.90.1",Ka={"X-Client-Info":`storage-js/${za}`};var Wa=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);(null==s?void 0:s.useNewHostname)&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Aa(Aa({},Ka),t),this.fetch=xa(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await $a(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await $a(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Pa(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(wa(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await Da(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(wa(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Za=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Aa(Aa({},Ka),t),this.fetch=xa(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;void 0!==(null==e?void 0:e.limit)&&r.set("limit",e.limit.toString()),void 0!==(null==e?void 0:e.offset)&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await $a(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(wa(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!(e=>!(!e||"string"!=typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new ba("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new va({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(e,t){const r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(a){if(s)throw a;return{data:null,error:a}}}}})}};const Ja={"X-Client-Info":`storage-js/${za}`,"Content-Type":"application/json"};var Ha=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ga(e){return"object"==typeof e&&null!==e&&"__isStorageVectorsError"in e}var Ya=class extends Ha{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Xa=class extends Ha{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Qa=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),en=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tn=(e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(a.headers=Aa({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,Aa(Aa({},a),r)):a};async function rn(e,t,r,s,a,n){return new Promise((i,o)=>{e(r,tn(t,s,a,n)).then(e=>{if(!e.ok)throw e;if(null==s?void 0:s.noResolveJson)return e;const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>i(e)).catch(e=>(async(e,t,r)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){const r=e.status||500,s=e;if("function"==typeof s.json)s.json().then(e=>{const s=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new Ya(en(e),r,s))}).catch(()=>{const e=r+"";t(new Ya(s.statusText||`HTTP ${r} error`,r,e))});else{const e=r+"";t(new Ya(s.statusText||`HTTP ${r} error`,r,e))}}else t(new Xa(en(e),e))})(e,o,s))})}async function sn(e,t,r,s,a){return rn(e,"POST",t,s,a,r)}var an=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Aa(Aa({},Ja),t),this.fetch=Qa(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await sn(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ga(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await sn(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ga(s))return{data:null,error:s};throw s}}},nn=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Aa(Aa({},Ja),t),this.fetch=Qa(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await sn(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and "+(e.segmentCount-1))}return{data:await sn(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await sn(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}},on=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Aa(Aa({},Ja),t),this.fetch=Qa(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await sn(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}},ln=class extends on{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new cn(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(e={}){return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},cn=class extends an{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){return(()=>super.createIndex)().call(this,Aa(Aa({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return(()=>super.listIndexes)().call(this,Aa(Aa({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new un(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},un=class extends nn{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,Aa(Aa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,Aa(Aa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(e={}){var t=this;return(()=>super.listVectors)().call(t,Aa(Aa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,Aa(Aa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,Aa(Aa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},dn=class extends Wa{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Ma(this.url,this.headers,e,this.fetch)}get vectors(){return new ln(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Za(this.url+"/iceberg",this.headers,this.fetch)}};const hn="2.90.1",fn=3e4,pn=9e4,mn={"X-Client-Info":`gotrue-js/${hn}`},gn="X-Supabase-Api-Version",yn={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},vn=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class bn extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function wn(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class _n extends bn{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class kn extends bn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class xn extends bn{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Sn extends xn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class En extends xn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Tn extends xn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class On extends xn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jn extends xn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class An extends xn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Rn extends xn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Cn(e){return wn(e)&&"AuthRetryableFetchError"===e.name}class Nn extends xn{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class In extends xn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pn=" \t\n\r=".split(""),Dn=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Pn.length;t+=1)e[Pn[t].charCodeAt(0)]=-2;for(let t=0;t<$n.length;t+=1)e[$n[t].charCodeAt(0)]=t;return e})();function Un(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r($n[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r($n[e]),t.queuedBits-=6}}function Vn(e,t,r){const s=Dn[e];if(!(s>-1)){if(-2===s)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Ln(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},n=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,s,r)};for(let i=0;i<e.length;i+=1)Vn(e.charCodeAt(i),a,n);return t.join("")}function Fn(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Bn(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Vn(e.charCodeAt(a),r,s);return new Uint8Array(t)}function qn(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const t=1024*(s-55296)&65535;s=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}Fn(s,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function Mn(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>Un(e,r,s)),Un(null,r,s),t.join("")}const zn=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Kn={tested:!1,writable:!1},Wn=()=>{if(!zn())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Kn.tested)return Kn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Kn.tested=!0,Kn.writable=!0}catch(t){Kn.tested=!0,Kn.writable=!1}return Kn.writable};const Zn=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),Jn=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Hn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(s){return r}},Gn=async(e,t)=>{await e.removeItem(t)};class Yn{constructor(){this.promise=new Yn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Xn(e){const t=e.split(".");if(3!==t.length)throw new In("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!vn.test(t[r]))throw new In("JWT not in base64url format");return{header:JSON.parse(Ln(t[0])),payload:JSON.parse(Ln(t[1])),signature:Bn(t[2]),raw:{header:t[0],payload:t[1]}}}function Qn(e){return("0"+e.toString(16)).substr(-2)}async function ei(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ti(e,t,r=!1){const s=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Qn).join("")}();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await Jn(e,`${t}-code-verifier`,a);const n=await ei(s);return[n,s===n?"plain":"s256"]}Yn.promiseConstructor=Promise;const ri=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const si=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ai(e){if(!si.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ni(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ii(e){return JSON.parse(JSON.stringify(e))}const oi=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),li=[502,503,504];async function ci(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new Rn(oi(e),0);if(li.includes(e.status))throw new Rn(oi(e),e.status);let s,a;try{s=await e.json()}catch(i){throw new kn(oi(i),i)}const n=function(e){const t=e.headers.get(gn);if(!t)return null;if(!t.match(ri))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(i){return null}}(e);if(n&&n.getTime()>=yn.timestamp&&"object"==typeof s&&s&&"string"==typeof s.code?a=s.code:"object"==typeof s&&s&&"string"==typeof s.error_code&&(a=s.error_code),a){if("weak_password"===a)throw new Nn(oi(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Sn}else if("object"==typeof s&&s&&"object"==typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new Nn(oi(s),e.status,s.weak_password.reasons);throw new _n(oi(s),e.status||500,a)}async function ui(e,t,r,s){var a;const n=Object.assign({},null==s?void 0:s.headers);n[gn]||(n[gn]=yn.name),(null==s?void 0:s.jwt)&&(n.Authorization=`Bearer ${s.jwt}`);const i=null!==(a=null==s?void 0:s.query)&&void 0!==a?a:{};(null==s?void 0:s.redirectTo)&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,r,s,a,n){const i=((e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))})(t,s,a,n);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw new Rn(oi(l),0)}o.ok||await ci(o);if(null==s?void 0:s.noResolveJson)return o;try{return await o.json()}catch(l){await ci(l)}}(e,t,r+o,{headers:n,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}function di(e){var t;let r=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function hi(e){const t=di(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function fi(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function pi(e){return{data:e,error:null}}function mi(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:n}=e,i=l(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:n},user:Object.assign({},i)},error:null}}function gi(e){return e}const yi=["global","local","others"];class vi{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Zn(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=yi[0]){if(yi.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yi.join(", ")}`);try{return await ui(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(wn(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ui(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:fi})}catch(r){if(wn(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=l(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await ui(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:mi,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(wn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ui(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:fi})}catch(t){if(wn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await ui(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:gi});if(c.error)throw c.error;const u=await c.json(),d=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(wn(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){ai(e);try{return await ui(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:fi})}catch(t){if(wn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ai(e);try{return await ui(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:fi})}catch(r){if(wn(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){ai(e);try{return await ui(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:fi})}catch(r){if(wn(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){ai(e.userId);try{const{data:t,error:r}=await ui(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(wn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ai(e.userId),ai(e.id);try{return{data:await ui(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(wn(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await ui(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:gi});if(c.error)throw c.error;const u=await c.json(),d=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(wn(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await ui(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(wn(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await ui(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(wn(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await ui(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(r){if(wn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await ui(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(wn(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await ui(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(wn(t))return{data:null,error:t};throw t}}}function bi(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const wi=!!(globalThis&&Wn()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class _i extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ki extends _i{}async function xi(e,t,r){const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(!s){if(0===t)throw new ki(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wi)try{await globalThis.navigator.locks.query()}catch(a){}return await r()}try{return await r()}finally{}}))}function Si(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Ei(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class Ti extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(a=null!=s?s:r instanceof Error?r.name:void 0)&&void 0!==a?a:"Unknown Error",this.code=t}}class Oi extends Ti{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function ji({error:e,options:t}){var r,s,a;const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new Ti({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(!0===(null===(r=n.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey))return new Ti({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&"required"===(null===(s=n.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new Ti({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if("required"===(null===(a=n.authenticatorSelection)||void 0===a?void 0:a.userVerification))return new Ti({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new Ti({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new Ti({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name){return 0===n.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new Ti({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ti({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e})}if("SecurityError"===e.name){const t=window.location.hostname;if(!Pi(t))return new Ti({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(n.rp.id!==t)return new Ti({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new Ti({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new Ti({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ti({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Ai({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new Ti({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new Ti({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){const t=window.location.hostname;if(!Pi(t))return new Ti({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new Ti({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new Ti({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ti({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}const Ri=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Ci(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=l(e,["challenge","user","excludeCredentials"]),n=Bn(t).buffer,i=Object.assign(Object.assign({},r),{id:Bn(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:n,user:i});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:Bn(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}function Ni(e){if(!e)throw new Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=l(e,["challenge","allowCredentials"]),a=Bn(t).buffer,n=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){n.allowCredentials=new Array(r.length);for(let e=0;e<r.length;e++){const t=r[e];n.allowCredentials[e]=Object.assign(Object.assign({},t),{id:Bn(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return n}function Ii(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Mn(new Uint8Array(e.response.attestationObject)),clientDataJSON:Mn(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function $i(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Mn(new Uint8Array(a.authenticatorData)),clientDataJSON:Mn(new Uint8Array(a.clientDataJSON)),signature:Mn(new Uint8Array(a.signature)),userHandle:a.userHandle?Mn(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function Pi(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Di(){var e,t;return!!(zn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Ui={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Vi={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Li(...e){const t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(const a of e)if(a)for(const e in a){const n=a[e];if(void 0!==n)if(Array.isArray(n))s[e]=n;else if(r(n))s[e]=n;else if(t(n)){const r=s[e];t(r)?s[e]=Li(r,n):s[e]=Li(n)}else s[e]=n}return s}class Fi{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:n,error:i}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!n)return{data:null,error:i};const o=null!=s?s:Ri.createNewAbortSignal();if("create"===n.webauthn.type){const{user:e}=n.webauthn.credential_options.publicKey;e.name||(e.name=`${e.id}:${r}`),e.displayName||(e.displayName=e.name)}switch(n.webauthn.type){case"create":{const t=function(e,t){return Li(Ui,e,t||{})}(n.webauthn.credential_options.publicKey,null==a?void 0:a.create),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Oi("Browser returned unexpected credential type",t)}:{data:null,error:new Oi("Empty credential response",t)}}catch(t){return{data:null,error:ji({error:t,options:e})}}}({publicKey:t,signal:o});return r?{data:{factorId:e,challengeId:n.id,webauthn:{type:n.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}case"request":{const t=function(e,t){return Li(Vi,e,t||{})}(n.webauthn.credential_options.publicKey,null==a?void 0:a.request),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Oi("Browser returned unexpected credential type",t)}:{data:null,error:new Oi("Empty credential response",t)}}catch(t){return{data:null,error:Ai({error:t,options:e})}}}(Object.assign(Object.assign({},n.webauthn.credential_options),{publicKey:t,signal:o}));return r?{data:{factorId:e,challengeId:n.id,webauthn:{type:n.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}}}catch(n){return wn(n)?{data:null,error:n}:{data:null,error:new kn("Unexpected error in challenge",n)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:s}={}},a){if(!t)return{data:null,error:new bn("rpId is required for WebAuthn authentication")};try{if(!Di())return{data:null,error:new kn("Browser does not support WebAuthn",null)};const{data:n,error:i}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!n)return{data:null,error:i};const{webauthn:o}=n;return this._verify({factorId:e,challengeId:n.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(n){return wn(n)?{data:null,error:n}:{data:null,error:new kn("Unexpected error in authenticate",n)}}}async _register({friendlyName:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:s}={}},a){if(!t)return{data:null,error:new bn("rpId is required for WebAuthn registration")};try{if(!Di())return{data:null,error:new kn("Browser does not support WebAuthn",null)};const{data:n,error:i}=await this._enroll({friendlyName:e});if(!n)return await this.client.mfa.listFactors().then(t=>{var r;return null===(r=t.data)||void 0===r?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:i};const{data:o,error:l}=await this._challenge({factorId:n.id,friendlyName:n.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return o?this._verify({factorId:n.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:l}}catch(n){return wn(n)?{data:null,error:n}:{data:null,error:new kn("Unexpected error in register",n)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Bi={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function qi(e,t,r){return await r()}const Mi={};class zi{get jwks(){var e,t;return null!==(t=null===(e=Mi[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Mi[this.storageKey]=Object.assign(Object.assign({},Mi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Mi[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mi[this.storageKey]=Object.assign(Object.assign({},Mi[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Bi),e);if(this.storageKey=a.storageKey,this.instanceID=null!==(t=zi.nextInstanceID[this.storageKey])&&void 0!==t?t:0,zi.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,"function"==typeof a.debug&&(this.logger=a.debug),this.instanceID>0&&zn()){this._logPrefix();this.logDebugMessages}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new vi({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Zn(a.fetch),this.lock=a.lock||qi,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&zn()&&(null===(r=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=xi:this.lock=qi,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Fi(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Wn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=bi(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=bi(this.memoryStorage)),zn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${hn}) ${(new Date).toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(zn()&&(t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(s){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),zn()&&this.detectSessionInUrl&&"none"!==r){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return wn(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return{error:a}}const{session:n,redirectType:i}=s;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return wn(t)?this._returnResult({error:t}):this._returnResult({error:new kn("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken}},xform:di}),{data:n,error:i}=a;if(i||!n)return this._returnResult({data:{user:null,session:null},error:i});const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(a){if(wn(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:r,password:s,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await ti(this.storage,this.storageKey)),a=await ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},xform:di})}else{if(!("phone"in e))throw new Tn("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:i}=e;a=await ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(r=null==i?void 0:i.data)&&void 0!==r?r:{},channel:null!==(s=null==i?void 0:i.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:di})}}const{data:n,error:i}=a;if(i||!n)return await Gn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:i});const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(a){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:s,options:a}=e;t=await ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:hi})}else{if(!("phone"in e))throw new Tn("You must provide either an email or phone number and a password");{const{phone:r,password:s,options:a}=e;t=await ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:hi})}}const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const e=new En;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(wn(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,n,i,o,l,c,u,d;let h,f;if("message"in e)h=e.message,f=e.signature;else{const{chain:u,wallet:d,statement:p,options:m}=e;let g;if(zn())if("object"==typeof d)g=d;else{const e=window;if(!("ethereum"in e)||"object"!=typeof e.ethereum||!("request"in e.ethereum)||"function"!=typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!=typeof d||!(null==m?void 0:m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=d}const y=new URL(null!==(t=null==m?void 0:m.url)&&void 0!==t?t:window.location.href),v=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!v||0===v.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=Si(v[0]);let w=null===(r=null==m?void 0:m.signInWithEthereum)||void 0===r?void 0:r.chainId;if(!w){const e=await g.request({method:"eth_chainId"});w=parseInt(e,16)}h=function(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:n=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:u,uri:d,version:h}=e;if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);const f=`${u?`${u}://${s}`:s} wants you to sign in with your Ethereum account:\n${Si(e.address)}\n\n${e.statement?`${e.statement}\n`:""}`;let p=`URI: ${d}\nVersion: ${h}\nChain ID: ${r}${i?`\nNonce: ${i}`:""}\nIssued At: ${n.toISOString()}`;if(a&&(p+=`\nExpiration Time: ${a.toISOString()}`),o&&(p+=`\nNot Before: ${o.toISOString()}`),l&&(p+=`\nRequest ID: ${l}`),c){let e="\nResources:";for(const t of c){if(!t||"string"!=typeof t)throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`\n- ${t}`}p+=e}return`${f}\n${p}`}({domain:y.host,address:b,statement:p,uri:y.href,version:"1",chainId:w,nonce:null===(s=null==m?void 0:m.signInWithEthereum)||void 0===s?void 0:s.nonce,issuedAt:null!==(n=null===(a=null==m?void 0:m.signInWithEthereum)||void 0===a?void 0:a.issuedAt)&&void 0!==n?n:new Date,expirationTime:null===(i=null==m?void 0:m.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(o=null==m?void 0:m.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null==m?void 0:m.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null==m?void 0:m.signInWithEthereum)||void 0===c?void 0:c.resources}),f=await g.request({method:"personal_sign",params:[Ei(h),b]})}try{const{data:t,error:r}=await ui(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:f},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:di});if(r)throw r;if(!t||!t.session||!t.user){const e=new En;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(p){if(wn(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var t,r,s,a,n,i,o,l,c,u,d,h;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:d,wallet:h,statement:m,options:g}=e;let y;if(zn())if("object"==typeof h)y=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=h}const v=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),m?{statement:m}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${v.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(s=null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:(new Date).toISOString()}`,...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(u=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await y.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:r}=await ui(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Mn(p)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:di});if(r)throw r;if(!t||!t.session||!t.user){const e=new En;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(m){if(wn(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(e){const t=await Hn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new An;const{data:t,error:a}=await ui(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:di});if(await Gn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!t||!t.session||!t.user){const e=new En;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:a})}catch(a){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:n}=e,i=await ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:di}),{data:o,error:l}=i;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o||!o.session||!o.user){const e=new En;return this._returnResult({data:{user:null,session:null},error:e})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:l})}catch(t){if(wn(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,n;try{if("email"in e){const{email:s,options:a}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await ti(this.storage,this.storageKey));const{error:o}=await ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null==a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:n,code_challenge_method:i},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){const{phone:t,options:r}=e,{data:i,error:o}=await ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(a=null==r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(n=null==r?void 0:r.channel)&&void 0!==n?n:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o})}throw new Tn("You must provide either an email or phone number.")}catch(i){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:n,error:i}=await ui(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:di});if(i)throw i;if(!n){throw new Error("An error occurred on token verification.")}const o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(s){if(wn(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,n;try{let i=null,o=null;"pkce"===this.flowType&&([i,o]=await ti(this.storage,this.storageKey));const l=await ui(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:pi});return(null===(a=l.data)||void 0===a?void 0:a.url)&&zn()&&!(null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(i){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Sn;const{error:s}=await ui(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(wn(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:n}=await ui(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:n})}if("phone"in e){const{phone:r,type:s,options:a}=e,{data:n,error:i}=await ui(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:i})}throw new Tn("You must provide either an email or phone number and a type")}catch(t){if(wn(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Hn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<pn;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await Hn(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=ni()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,r,s)=>{if("__isInsecureUserWarningProxy"===r)return!0;if("symbol"==typeof r){const t=r.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,r,s)}return t.value||"string"!=typeof r||(t.value=!0),Reflect.get(e,r,s)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:fi}):await this._useSession(async e=>{var t,r,s;const{data:a,error:n}=e;if(n)throw n;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(s=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0,xform:fi}):{data:{user:null},error:new Sn}})}catch(t){if(wn(t))return function(e){return wn(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new Sn;const n=s.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await ti(this.storage,this.storageKey));const{data:l,error:c}=await ui(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:n.access_token,xform:fi});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),this._returnResult({data:{user:n.user},error:null})})}catch(r){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Sn;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:n}=Xn(e.access_token);if(n.exp&&(r=n.exp,s=r<=t),s){const{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:s,error:n}=await this._getUser(e.access_token);if(n)throw n;a={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(wn(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:s,error:a}=t;if(a)throw a;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new Sn;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(wn(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!zn())throw new On("No browser detected.");if(e.error||e.error_description||e.error_code)throw new On(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new jn("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new On("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new jn("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:n,expires_in:i,expires_at:o,token_type:l}=e;if(!(a&&i&&n&&l))throw new On("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(i);let d=c+u;o&&(d=parseInt(o));const{data:h,error:f}=await this._getUser(a);if(f)throw f;const p={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:u,expires_at:d,refresh_token:n,token_type:l,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:p,redirectType:e.type},error:null})}catch(r){if(wn(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Hn(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const n=null===(r=s.session)||void 0===r?void 0:r.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return wn(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await Gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:s},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(a){await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await ti(this.storage,this.storageKey,!0));try{return await ui(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async t=>{var r,s,a,n,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await ui(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})});if(s)throw s;return zn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(r){if(wn(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:n,provider:i,token:o,access_token:l,nonce:c}=e,u=await ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(r=null==a?void 0:a.access_token)&&void 0!==r?r:void 0,body:{provider:i,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:di}),{data:d,error:h}=u;return h?this._returnResult({data:{user:null,session:null},error:h}):d&&d.session&&d.user?(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:h})):this._returnResult({data:{user:null,session:null},error:new En})}catch(s){if(await Gn(this.storage,`${this.storageKey}-code-verifier`),wn(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:n}=t;if(n)throw n;return await ui(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(s=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0})})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await ui(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:di})),s=(e,t)=>{const r=200*Math.pow(2,e);return t&&Cn(t)&&Date.now()+r-a<fn},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await r(n);if(!s(n,null,t))return void e(t)}catch(a){if(!s(n,a))return void t(a)}})()}))}catch(a){if(this._debug(t,"error",a),wn(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(t,"end")}var r,s}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),zn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await Hn(this.storage,this.storageKey);if(a&&this.userStorage){let t=await Hn(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await Jn(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:ni()}else if(a&&!a.user&&!a.user){const e=await Hn(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(a.user=e.user,await Gn(this.storage,this.storageKey+"-user"),await Jn(this.storage,this.storageKey,a)):a.user=ni()}if(this._debug(r,"session from storage",a),!this._isValidSession(a))return this._debug(r,"session is not valid"),void(null!==a&&await this._removeSession());const n=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<pn;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(Cn(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null==e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(s){this._debug(r,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return void this._debug(r,"error",a)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Sn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Yn;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Sn;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={data:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(a){if(this._debug(s,"error",a),wn(a)){const e={data:null,error:a};return Cn(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(a){s.push(a)}});if(await Promise.all(a),s.length>0){for(let e=0;e<s.length;e+=1);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Gn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await Jn(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const s=ii(e);await Jn(this.storage,this.storageKey,s)}else{const e=ii(t);await Jn(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Gn(this.storage,this.storageKey),await Gn(this.storage,this.storageKey+"-code-verifier"),await Gn(this.storage,this.storageKey+"-user"),this.userStorage&&await Gn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&zn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),fn);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*r.expires_at-t)/fn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof _i))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await ti(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await ui(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:n}=t;if(n)return this._returnResult({data:null,error:n});const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await ui(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(s=null==o?void 0:o.totp)||void 0===s?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const n=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?Ii(e.webauthn.credential_response):$i(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:o}=await ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:n,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return o?this._returnResult({data:null,error:o}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:o}))})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const n=await ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});if(n.error)return n;const{data:i}=n;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Ci(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Ni(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])s.all.push(a),"verified"===a.status&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Xn(r.access_token);let n=null;a.aal&&(n=a.aal);let i=n;(null!==(t=null===(e=r.user.factors)||void 0===e?void 0:e.filter(e=>"verified"===e.status))&&void 0!==t?t:[]).length>0&&(i="aal2");return{data:{currentLevel:n,nextLevel:i,currentAuthenticationMethods:a.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await ui(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Sn})})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new Sn});const n=await ui(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&zn()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(r){if(wn(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new Sn});const n=await ui(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&zn()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(r){if(wn(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await ui(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Sn})})}catch(e){if(wn(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?(await ui(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Sn})})}catch(t){if(wn(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>s)return r;const{data:a,error:n}=await ui(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}const{header:s,payload:a,signature:n,raw:{header:i,payload:o}}=Xn(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=s.alg&&!s.alg.startsWith("HS")&&s.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(s.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:s,signature:n},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(s.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,u,n,qn(`${i}.${o}`))))throw new In("Invalid JWT signature");return{data:{claims:a,header:s,signature:n},error:null}}catch(r){if(wn(r))return this._returnResult({data:null,error:r});throw r}}}zi.nextInstanceID={};const Ki=zi;let Wi="";Wi="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Zi={headers:{"X-Client-Info":`supabase-js-${Wi}/2.90.1`}},Ji={schema:"public"},Hi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Gi={};function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xi(e){var t=function(e,t){if("object"!=Yi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=Yi(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yi(t)?t:t+""}function Qi(e,t,r){return(t=Xi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(r),!0).forEach(function(t){Qi(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const ro=(e,t,r)=>{const s=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r),a=Headers;return async(r,n)=>{var i;const o=null!==(i=await t())&&void 0!==i?i:e;let l=new a(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),s(r,to(to({},n),{},{headers:l}))}};var so=class extends Ki{constructor(e){super(e)}},ao=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const n=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(s){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);const i=`sb-${n.hostname.split(".")[0]}-auth-token`,o=function(e,t){var r,s;const{db:a,auth:n,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:to(to({},l),a),auth:to(to({},c),n),realtime:to(to({},u),i),storage:{},global:to(to(to({},d),o),{},{headers:to(to({},null!==(r=null==d?void 0:d.headers)&&void 0!==r?r:{}),null!==(s=null==o?void 0:o.headers)&&void 0!==s?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:Ji,realtime:Gi,auth:to(to({},Hi),{},{storageKey:i}),global:Zi});var l;(this.storageKey=null!==(s=o.auth.storageKey)&&void 0!==s?s:"",this.headers=null!==(a=o.global.headers)&&void 0!==a?a:{},o.accessToken)?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(l=o.auth)&&void 0!==l?l:{},this.headers,o.global.fetch);this.fetch=ro(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(to({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>{}),this.rest=new _s(new URL("rest/v1",n).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch}),this.storage=new dn(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new ps(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,r=this;if(r.accessToken)return await r.accessToken();const{data:s}=await r.auth.getSession();return null!==(e=null===(t=s.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:n,flowType:i,lock:o,debug:l,throwOnError:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new so({url:this.authUrl.href,headers:to(to({},h),u),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:i,lock:o,debug:l,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new da(this.realtimeUrl.href,to(to({},e),{},{params:to(to({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=r,this.realtime.setAuth(r))}};!function(){if("undefined"!=typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(null==t)return!1;const r=t.match(/^v(\d+)\./);!!r&&parseInt(r[1],10)}(),Array(12).fill(0);let no=1;const io=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:r,...s}=e,a="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:no++,n=this.toasts.find(e=>e.id===a),i=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),n?this.toasts=this.toasts.map(t=>t.id===a?(this.publish({...t,...e,id:a,title:r}),{...t,...e,id:a,dismissible:i,title:r}):t):this.addToast({title:r,...s,dismissible:i,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;void 0!==t.loading&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));const a=Promise.resolve(e instanceof Function?e():e);let n,i=void 0!==r;const o=a.then(async e=>{n=["resolve",e];if(s.isValidElement(e))i=!1,this.create({id:r,type:"default",message:e});else if(oo(e)&&!e.ok){i=!1;const a="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,o="object"==typeof a&&!s.isValidElement(a)?a:{message:a};this.create({id:r,type:"error",description:n,...o})}else if(e instanceof Error){i=!1;const a="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,o="object"==typeof a&&!s.isValidElement(a)?a:{message:a};this.create({id:r,type:"error",description:n,...o})}else if(void 0!==t.success){i=!1;const a="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description,o="object"==typeof a&&!s.isValidElement(a)?a:{message:a};this.create({id:r,type:"success",description:n,...o})}}).catch(async e=>{if(n=["reject",e],void 0!==t.error){i=!1;const a="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,o="object"==typeof a&&!s.isValidElement(a)?a:{message:a};this.create({id:r,type:"error",description:n,...o})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),null==t.finally||t.finally.call(t)}),l=()=>new Promise((e,t)=>o.then(()=>"reject"===n[0]?t(n[1]):e(n[1])).catch(t));return"string"!=typeof r&&"number"!=typeof r?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{const r=(null==t?void 0:t.id)||no++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},oo=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,lo=(e,t)=>{const r=(null==t?void 0:t.id)||no++;return io.addToast({title:e,...t,id:r}),r},co=Object.assign(lo,{success:io.success,info:io.info,warning:io.warning,error:io.error,custom:io.custom,message:io.message,promise:io.promise,dismiss:io.dismiss,loading:io.loading},{getHistory:()=>io.toasts,getToasts:()=>io.getActiveToasts()});!function(e){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");let uo=!1;const ho=new ao(void 0,void 0,{global:{fetch:async(e,t)=>{let r=String(e);const s=new URL(r),a=String(s.hostname);a.includes("backend.")||a.includes(".supabase.co")||(r=s.pathname+s.search,/((bce|console).*.baidu.*\.com)$|(\.)?miaoda\.(cn|io)$/.test(document.location.hostname)||(r=r.replace(/(\/miaoda([-_\w]+)?)(\/(backend|supabase))/,"$1/runtime$3")));let n=await fetch(r,t);try{const e=await n.clone().arrayBuffer(),t=new Response(e,n);if(!n.ok){let e;try{e=await t.json()}catch(i){e={message:"",status:n.status}}let r=e.message||e.msg||"";if("SupabaseNotReady"===e.code&&!uo){uo=!0;try{"function"==typeof co?co(r):alert(r)}catch(i){alert(r)}}}}catch(o){}return n}},auth:{storageKey:"sb-auth-token"}});const fo=os({name:is().min(3,"Nome deve ter pelo menos 3 caracteres").max(100,"Nome muito longo"),email:is().email("Email invlido").max(100,"Email muito longo"),subject:is().min(5,"Assunto deve ter pelo menos 5 caracteres").max(200,"Assunto muito longo"),message:is().min(10,"Mensagem deve ter pelo menos 10 caracteres").max(1e3,"Mensagem muito longa")});function po(){const[e,r]=a.useState(!1),[n,i]=a.useState(!1),[o,l]=a.useState(null),x=function(e={}){const t=s.useRef(void 0),r=s.useRef(void 0),[a,n]=s.useState({isDirty:!1,isValidating:!1,isLoading:V(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:V(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:a},e.defaultValues&&!V(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:r,...s}=We(e);t.current={...s,formState:a}}const i=t.current.control;return i._options=e,ae(()=>{const e=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(e=>({...e,isReady:!0})),i._formState.isReady=!0,e},[i]),s.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),s.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),s.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),s.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),s.useEffect(()=>{if(i._proxyFormState.isDirty){const e=i._getDirty();e!==a.isDirty&&i._subjects.state.next({isDirty:e})}},[i,a.isDirty]),s.useEffect(()=>{var t;e.values&&!ce(e.values,r.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),(null===(t=i._options.resetOptions)||void 0===t?void 0:t.keepIsValid)||i._setValid(),r.current=e.values,n(e=>({...e}))):i._resetDefaultValues()},[i,e.values]),s.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=se(a,i),t.current}({resolver:Ot(fo),defaultValues:{name:"",email:"",subject:"",message:""}});return t.jsxs(c,{children:[t.jsx(u,{...b}),t.jsx("div",{className:"py-8 xl:py-12",children:t.jsxs("div",{className:"container mx-auto px-4 max-w-5xl",children:[t.jsxs("div",{className:"text-center mb-8 xl:mb-12",children:[t.jsx("h1",{className:"text-3xl xl:text-4xl font-bold text-foreground mb-4 max-sm:text-2xl",children:"Entre em Contato"}),t.jsx("p",{className:"text-base xl:text-lg text-muted-foreground max-sm:text-sm",children:"Tem dvidas ou sugestes? Estamos aqui para ajudar!"})]}),t.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8 xl:mb-12",children:[t.jsx(d,{className:"shadow-lg hover:shadow-xl transition-shadow",children:t.jsxs(h,{className:"p-6 xl:p-8 text-center",children:[t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-primary/10 p-4 rounded-full",children:t.jsx(f,{className:"h-8 w-8 xl:h-10 xl:w-10 text-primary"})})}),t.jsx("h3",{className:"text-lg xl:text-xl font-bold text-foreground mb-2 max-sm:text-base",children:"Email"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"contato@meuddd.com.br"})]})}),t.jsx(d,{className:"shadow-lg hover:shadow-xl transition-shadow",children:t.jsxs(h,{className:"p-6 xl:p-8 text-center",children:[t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-accent/10 p-4 rounded-full",children:t.jsx(p,{className:"h-8 w-8 xl:h-10 xl:w-10 text-accent"})})}),t.jsx("h3",{className:"text-lg xl:text-xl font-bold text-foreground mb-2 max-sm:text-base",children:"Localizao"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"So Paulo, SP - Brasil"})]})})]}),t.jsx(d,{className:"shadow-lg mb-8",children:t.jsxs(h,{className:"p-6 xl:p-8",children:[t.jsx("h2",{className:"text-xl xl:text-2xl font-bold text-foreground mb-6 max-sm:text-lg",children:"Envie sua Mensagem"}),n&&t.jsxs("div",{className:"mb-6 p-4 bg-primary/10 border border-primary/20 rounded-lg flex items-start gap-3",children:[t.jsx(w,{className:"h-5 w-5 text-primary mt-0.5 shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm xl:text-base font-medium text-foreground",children:"Mensagem enviada com sucesso!"}),t.jsx("p",{className:"text-xs xl:text-sm text-muted-foreground mt-1",children:"Obrigado pelo contato. Responderemos em breve."})]})]}),o&&t.jsx("div",{className:"mb-6 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:t.jsx("p",{className:"text-sm xl:text-base text-destructive",children:o})}),t.jsx(Ye,{...x,children:t.jsxs("form",{onSubmit:x.handleSubmit(async e=>{r(!0),l(null),i(!1);try{const t={name:e.name,email:e.email,subject:e.subject,message:e.message},{data:r,error:s}=await async function(e){var t,r,s,a;try{if(!(null==(t=e.name)?void 0:t.trim()))throw new Error("Nome  obrigatrio");if(!(null==(r=e.email)?void 0:r.trim()))throw new Error("Email  obrigatrio");if(!(null==(s=e.subject)?void 0:s.trim()))throw new Error("Assunto  obrigatrio");if(!(null==(a=e.message)?void 0:a.trim()))throw new Error("Mensagem  obrigatria");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email))throw new Error("Email invlido");const{data:n,error:i}=await ho.from("contact_messages").insert([{name:e.name.trim(),email:e.email.trim().toLowerCase(),subject:e.subject.trim(),message:e.message.trim()}]).select().maybeSingle();if(i)throw new Error("Erro ao enviar mensagem. Tente novamente.");return{data:n,error:null}}catch(n){return{data:null,error:n instanceof Error?n:new Error("Erro desconhecido")}}}(t);if(s)return void l(s.message);r&&(i(!0),x.reset(),setTimeout(()=>{i(!1)},5e3))}catch(t){l("Erro ao enviar mensagem. Tente novamente.")}finally{r(!1)}}),className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[t.jsx(Qe,{control:x.control,name:"name",render:({field:r})=>t.jsxs(rt,{children:[t.jsx(st,{className:"text-sm xl:text-base",children:"Nome Completo"}),t.jsx(at,{children:t.jsx(m,{placeholder:"Seu nome completo",...r,disabled:e,className:"text-sm xl:text-base"})}),t.jsx(nt,{className:"text-xs xl:text-sm"})]})}),t.jsx(Qe,{control:x.control,name:"email",render:({field:r})=>t.jsxs(rt,{children:[t.jsx(st,{className:"text-sm xl:text-base",children:"Email"}),t.jsx(at,{children:t.jsx(m,{type:"email",placeholder:"seu@email.com",...r,disabled:e,className:"text-sm xl:text-base"})}),t.jsx(nt,{className:"text-xs xl:text-sm"})]})})]}),t.jsx(Qe,{control:x.control,name:"subject",render:({field:r})=>t.jsxs(rt,{children:[t.jsx(st,{className:"text-sm xl:text-base",children:"Assunto"}),t.jsx(at,{children:t.jsx(m,{placeholder:"Sobre o que voc gostaria de falar?",...r,disabled:e,className:"text-sm xl:text-base"})}),t.jsx(nt,{className:"text-xs xl:text-sm"})]})}),t.jsx(Qe,{control:x.control,name:"message",render:({field:r})=>t.jsxs(rt,{children:[t.jsx(st,{className:"text-sm xl:text-base",children:"Mensagem"}),t.jsx(at,{children:t.jsx(k,{placeholder:"Digite sua mensagem aqui...",className:"min-h-[150px] resize-none text-sm xl:text-base",...r,disabled:e})}),t.jsx(nt,{className:"text-xs xl:text-sm"})]})}),t.jsx(g,{type:"submit",disabled:e,className:"w-full xl:w-auto text-sm xl:text-base",size:"lg",children:e?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"animate-spin mr-2",children:""}),"Enviando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_,{className:"mr-2 h-4 w-4"}),"Enviar Mensagem"]})})]})})]})}),t.jsxs(d,{className:"shadow-lg mb-8",children:[t.jsx(y,{children:t.jsx(v,{className:"text-xl xl:text-2xl max-sm:text-lg",children:"Perguntas Frequentes"})}),t.jsxs(h,{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-base xl:text-lg font-bold text-foreground mb-2 max-sm:text-sm",children:"Como fao para encontrar o DDD de uma cidade?"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"Voc pode usar a busca na pgina inicial digitando o nome da cidade, ou navegar pela pgina de Estados e encontrar o estado correspondente para ver todas as cidades e seus DDDs."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base xl:text-lg font-bold text-foreground mb-2 max-sm:text-sm",children:"Os cdigos DDD esto atualizados?"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"Sim! Nossa base de dados  mantida atualizada com todos os cdigos DDD oficiais do Brasil, incluindo as mudanas mais recentes implementadas pela Anatel."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base xl:text-lg font-bold text-foreground mb-2 max-sm:text-sm",children:"Posso usar a busca por voz em qualquer navegador?"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"A busca por voz funciona melhor nos navegadores Chrome, Edge e Safari. Certifique-se de permitir o acesso ao microfone quando solicitado."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base xl:text-lg font-bold text-foreground mb-2 max-sm:text-sm",children:"O gerador de nmeros cria nmeros reais?"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"No. O gerador cria nmeros de exemplo aleatrios apenas para fins de teste e demonstrao. Estes nmeros podem ou no existir na realidade."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base xl:text-lg font-bold text-foreground mb-2 max-sm:text-sm",children:"Como posso sugerir melhorias para a plataforma?"}),t.jsx("p",{className:"text-sm xl:text-base text-muted-foreground max-sm:text-xs",children:"Adoraramos ouvir suas sugestes! Entre em contato conosco atravs do email contato@meuddd.com.br com suas ideias e feedback."})]})]})]}),t.jsx(d,{className:"shadow-lg bg-primary text-primary-foreground",children:t.jsxs(h,{className:"p-6 xl:p-8 text-center",children:[t.jsx("h2",{className:"text-xl xl:text-2xl font-bold mb-4 max-sm:text-lg",children:"Precisa de Ajuda?"}),t.jsx("p",{className:"text-sm xl:text-base mb-6 max-sm:text-xs",children:"Nossa equipe est pronta para responder suas dvidas e ajudar voc a encontrar as informaes que precisa sobre cdigos DDD do Brasil."}),t.jsx("p",{className:"text-base xl:text-lg font-medium max-sm:text-sm",children:"Horrio de atendimento: Segunda a Sexta, 9h s 18h"})]})})]})})]})}export{po as default};
